
c$$$
c$$$      IMPLICIT REAL*8 (A-H,O-Z)  
c$$$      COMMON/MRICOM/XNRH2O(880),XNRSO4(880),XNRNO3(880),XNRSEA(880)
c$$$     A             ,XNIH2O(880),XNISO4(880),XNINO3(880),XNISEA(880)
c$$$     B             ,XNLH2O(880),XNLSO4(880),XNLNO3(880),XNLSEA(880)
c$$$     C             ,WAVLEN(880),RHRSO4(880),RHRNO3(880),RHRSEA(880)  
c$$$     D             ,WAVNUM(880),RHISO4(880),RHINO3(880),RHISEA(880) 
c$$$     E                         ,RHLSO4(880),RHLNO3(880),RHLSEA(880) 
c$$$C                         
c$$$C     --------------------------------------------------------------------                                              
c$$$C     Sample test run of SUBROUTINE RHWMRI for specified relative humidity
c$$$C     for RH = 0.0, 0.37, 0.80, 0.9999, and for representative wavelengths
c$$$C                                and (for K=3)
c$$$C     Print dry and RH dependent refractive index from COMMON/MRICOM data.
c$$$C     --------------------------------------------------------------------
c$$$C 
c$$$      KW=66
c$$$      DO 130 K=1,3
c$$$      DO 120 IRH=1,4
c$$$      RH=0.0 
c$$$      IF(IRH.EQ.2) RH=0.37
c$$$      IF(IRH.EQ.3) RH=0.80 
c$$$      IF(IRH.EQ.4) RH=0.9999  
c$$$      IF(K.LT.3) WRITE(KW,6000) 
c$$$ 6000 FORMAT(/7X,'RH',6X,'WAVL',4X,'WAVN',9X,'XMRH2O   XMIH2O',8X
c$$$     +     ,'XMRSO4   XMISO4',8X,'XMRNO3   XMINO3',8X,'XMRSEA   XMISEA')        
c$$$      IF(K.EQ.3.AND.IRH.EQ.1) WRITE(KW,6100) 
c$$$ 6100 FORMAT(/7X,'RH',6X,'WAVL',4X,'WAVN',9X,'XNRH2O   XNIH2O',8X
c$$$     +     ,'XNRSO4   XNISO4',8X,'XNRNO3   XNINO3',8X,'XNRSEA   XMISEA')
c$$$      IF(K.EQ.3.AND.IRH.GT.1) WRITE(KW,6200) 
c$$$ 6200 FORMAT(/7X,'RH',6X,'WAVL',4X,'WAVN',9X,'XNRH2O   XNIH2O',8X
c$$$     +     ,'RHRSO4   RHISO4',8X,'RHRNO3   RHINO3',8X,'RHRSEA   RHISEA')
c$$$      DO 110 I=1,27
c$$$      IF(K.EQ.1) THEN
c$$$      WAVL=0.2+(I-1)/20.0  
c$$$      ENDIF
c$$$      IF(K.EQ.2) THEN
c$$$      WAVL=4.99+(I-1)/1000.0 
c$$$      IF(I.EQ.24) WAVL=10000.D0/1995.D0  
c$$$      ENDIF              
c$$$      IF(K.EQ.3) GO TO 105
c$$$      WAVN=10000.D0/WAVL
c$$$      CALL RHWMRI(RH,WAVL
c$$$     +      ,XMRH2O,XMIH2O,XMRSO4,XMISO4,XMRNO3,XMINO3,XMRSEA,XMISEA)
c$$$      WRITE(KW,6300)I,RH,WAVL,WAVN,XMRH2O,XMIH2O,XMRSO4,XMISO4
c$$$     +                            ,XMRNO3,XMINO3,XMRSEA,XMISEA
c$$$ 6300 FORMAT(I3,F8.5,F10.6,F9.2,2X,4(F10.6,E13.6))  
c$$$      GO TO 110
c$$$  105 CONTINUE       
c$$$      IF(IRH.EQ.1) THEN
c$$$      WRITE(KW,6300)I,RH,WAVLEN(I),WAVNUM(I),XNRH2O(I),XNIH2O(I)
c$$$     +     ,XNRSO4(I),XNISO4(I),XNRNO3(I),XNINO3(I),XNRSEA(I),XNISEA(I)  
c$$$      ENDIF
c$$$      IF(IRH.GT.1) THEN
c$$$      WRITE(KW,6300)I,RH,WAVLEN(I),WAVNUM(I),XNRH2O(I),XNIH2O(I)
c$$$     +     ,RHRSO4(I),RHISO4(I),RHRNO3(I),RHINO3(I),RHRSEA(I),RHISEA(I)  
c$$$      ENDIF
c$$$  110 CONTINUE   
c$$$  120 CONTINUE            
c$$$  130 CONTINUE 
c$$$      STOP
c$$$      END  

      SUBROUTINE RHWMRI(RH,WAVL
     +      ,XMRH2O,XMIH2O,XMRSO4,XMISO4,XMRNO3,XMINO3,XMRSEA,XMISEA) 
C
      IMPLICIT REAL*8 (A-H,O-Z)  
      COMMON/MRICOM/XNRH2O(880),XNRSO4(880),XNRNO3(880),XNRSEA(880)
     A             ,XNIH2O(880),XNISO4(880),XNINO3(880),XNISEA(880)
     B             ,XNLH2O(880),XNLSO4(880),XNLNO3(880),XNLSEA(880)
     C             ,WAVLEN(880),RHRSO4(880),RHRNO3(880),RHRSEA(880)  
     D             ,WAVNUM(880),RHISO4(880),RHINO3(880),RHISEA(880) 
     E                         ,RHLSO4(880),RHLNO3(880),RHLSEA(880) 
!f2py intent(out) xmrh2o, xmih2o
!f2py intent(out) xmrso4, xmiso4, xmrno3, xmino3, xmrsea, xmisea
!f2py intent(in) rh, wavl    
C 
C-----------------------------------------------------------------------
C     RHWMRI  Returns the real and imaginary refractive indices for
C             Water, Ammonium Sulfate, Ammonium Nitrate, and Sea Salt
C             (these are designated by suffixes H2O, SO4, NO3, and SEA)  
C             for specified relative humidity (RH) and wavelength (WAVL)
C 
C             Also available (following CALL RHWMRI) in COMMON/MRICOM/ 
C             are the full spectral distributions of real and imaginary
C             refractice indices XNR and XNI for H2O, SO4, NO3, SEA for
C             specified: WAVLEN (in microns from 0.2 to 2000.0 microns)
C                        WAVNUM (in cm-1 from 20000.0 to 5.0 cm-1)
C
C             For the first 480 points spectral increment is 0.01 micron
C             from 0.2 to 5.0 microns (or, 20000 to 2000 cm-1)
C 
C             For the points 480-880, the spectral increment is 5 cm-1    
C             for 5 - 2000 microns, i.e., from 2000 cm-1 to 5 cm-1   
C
C             Variables XNL & RHL designate log base10 values of XNI,RHI
C-----------------------------------------------------------------------
C
C     Input:  RH   = Relative Humidity               (range 0.0 to 1.00)
C             WAVL = Wavelength in microns           (range 0.2 to 2000)
C                                       
C     Output:    XMRH2O,XMIH2O XMRSO4,XMISO4 XMRNO3,XMINO3 XMRSEA,XMISEA 
C                Real and imaginary refractive indices for given RH,WAVL
C                for Water, Ammonium Sulfate, Ammonium Nitrate, Sea Salt
C                  (with spectral data available in COMMON/MRICOM/...)  
C                                                
C                XNRSO4,XNISO4 XNRNO3,XNINO3 XNRSEA,XNISEA represent the
C                refractive indices of dry aerosol (RH < crystalization)  
C
C                RHRSO4,RHISO4  RHRNO3,RHINO3  RHRSEA,RHISEA include the
C                effect of relative humidity on aerosol refractive index
C
C     Remark: RHWMRI calls the subroutines WATER, AMMSO4, AMMNO3, SEASAL
C             which can be called separately, or independently to return
C             the respective RH,WAVL dependent aerosol refractive index.
C
C             WATER is an independent subroutine, for a given wavelength
C                   WAVL it returns real and imaginary XMRH2O and XMIH2O
C                   The full spectrum is available in COMMON/MRICOM/ via
C                   XNRH2O,XNIH2O for wavelengths given in WAVLEN,WAVNUM
C
C             AMMSO4, AMMNO3, SEASAL can also be used independently, but
C                   require WATER for interpolating the RH dependence of
C                   the refractive index between "dry" and water values.
C-----------------------------------------------------------------------
C 
      CALL WATER(WAVL,XMRH2O,XMIH2O)
      CALL AMMSO4(RH,WAVL,XMRSO4,XMISO4)
      CALL AMMNO3(RH,WAVL,XMRNO3,XMINO3)  
      CALL SEASAL(RH,WAVL,XMRSEA,XMISEA)
      RETURN
      END
 
      SUBROUTINE WATER(WAVL,XNR,XNI)
C
      IMPLICIT REAL*8 (A-H,O-Z)  
      COMMON/MRICOM/XNRH2O(880),XNRSO4(880),XNRNO3(880),XNRSEA(880)
     A             ,XNIH2O(880),XNISO4(880),XNINO3(880),XNISEA(880)
     B             ,XNLH2O(880),XNLSO4(880),XNLNO3(880),XNLSEA(880)
     C             ,WAVLEN(880),RHRSO4(880),RHRNO3(880),RHRSEA(880)  
     D             ,WAVNUM(880),RHISO4(880),RHINO3(880),RHISEA(880) 
     E                         ,RHLSO4(880),RHLNO3(880),RHLSEA(880) 
!f2py intent(in) wavl    
!f2py intent(out) xnr, xni

C
C-----------------------------------------------------------------------
C     WATER    Returns real & imaginary refractive indices of pure Water 
C
C     Input:   WAVL  Wavelength in microns (between 0.2 to 2000 microns)
C
C     Output:  XNR & XNI  Real and imaginary refractive indices of Water
C          
C              Also available in COMMON/MRICOM/, the spectral dependence
C              of real (XNRH2O) and imaginary (XNIH2O) refaractive index
C              from 0.2 to 2000 microns (0.01 increment 0.2-5.0 microns)
C              from 5 to 2000 microns: (5 cm-1 increment 2000 to 5 cm-1)
C              Wavelength is given in WAVLEN (microns) and WAVNUM (cm-1)
C
C              Spectral interpolation is linear for XNR, linear in log10
C              for XNI using XNLH2O which is log10(XNI) in COMMON/MRICOM
C-----------------------------------------------------------------------
C     Remarks:
C              The refractive indices of water are smoothly interpolated 
C              from data tabulated by:        
C
C              Hale and Querry (1973) Appl Opt 12, 555-563 
C              Palmer & Williams (1974) J Op Soc Am 64, 1107-1110
C              Downing & Williams (1975) JGR 80, 1656-1661
C              Tang & Munkelwitz (1991) Aer Sci & Tech 15, 201-207
C              Kou et al (1993) Appl Opt 32, 3531-3540
C
C              For interval: 0.2 - 0.7 mm utilizes H & Q 1973 data 
C                            0.7 - 2.0 mm utilizes P & W 1974 data 
C                            2.0 -1000 mm utilizes D & W 1975 data 
C
C              TM(1991) Nr = 1.330 at 0.633 mm is the reference standard 
C
C              Kou et al. (1993) data are used for Ni from 0.7 to 2.7 mm
C
C-----------------------------------------------------------------------
C 
      DIMENSION NNRH2O(480),NNIH2O(480) 
      DIMENSION NRH2O1(180),NRH2O2(180),NRH2O3(120)
      DIMENSION NIH2O1(180),NIH2O2(180),NIH2O3(120)  
      EQUIVALENCE (NNRH2O(  1),NRH2O1(1)),(NNRH2O(181),NRH2O2(1))
      EQUIVALENCE (NNRH2O(361),NRH2O3(1)),(NNIH2O(  1),NIH2O1(1))
      EQUIVALENCE (NNIH2O(181),NIH2O2(1)),(NNIH2O(361),NIH2O3(1)) 
      DATA NRH2O1/  !      (Nr - 1)*100000 from 0.20 - 1.99 microns
     A  39600,38560,37724,37082,36583,36183,35854,35575,35333,35142,
     B  34971,34814,34670,34536,34414,34303,34202,34112,34033,33963, 
     C  33901,33847,33800,33760,33724,33693,33666,33641,33616,33592,
     D  33568,33545,33522,33500,33478,33457,33436,33416,33396,33377,
     E  33358,33340,33322,33305,33288,33271,33254,33237,33221,33205,
     F  33189,33174,33159,33144,33130,33116,33102,33088,33074,33061,
     G  33048,33035,33023,33011,32999,32987,32975,32963,32951,32939,
     H  32927,32915,32903,32891,32879,32867,32855,32843,32831,32819,
     I  32807,32795,32783,32771,32759,32747,32735,32722,32709,32696,
     J  32683,32669,32655,32641,32627,32613,32599,32585,32570,32556,
     K  32542,32527,32512,32496,32480,32464,32448,32432,32416,32400,
     L  32383,32367,32351,32334,32317,32299,32281,32263,32244,32225,
     M  32206,32186,32167,32148,32128,32109,32088,32068,32047,32027,
     N  32008,31989,31969,31950,31930,31910,31890,31868,31846,31823,
     O  31799,31774,31749,31723,31696,31668,31639,31610,31580,31550,
     P  31520,31490,31461,31432,31404,31377,31349,31323,31296,31269,
     Q  31243,31217,31191,31164,31140,31114,31089,31062,31036,31007,
     R  30978,30947,30914,30880,30845,30809,30770,30731,30689,30646/
      DATA NRH2O2/  !      (Nr - 1)*100000 from 2.00 - 3.79 microns
     A  30599,30550,30498,30442,30385,30325,30264,30202,30141,30079,
     B  30016,29953,29889,29823,29754,29683,29608,29530,29450,29367,
     C  29284,29201,29120,29039,28961,28882,28803,28722,28640,28555,
     D  28468,28380,28289,28197,28104,28011,27918,27822,27722,27616,
     E  27503,27381,27250,27114,26973,26829,26683,26536,26385,26231,
     F  26070,25901,25719,25523,25311,25081,24833,24568,24285,23983,
     G  23657,23305,22921,22501,22037,21518,20930,20263,19515,18696,
     H  17829,16953,16116,15230,14470,13980,13790,13890,14210,14670,
     I  15190,15730,16290,16872,17679,18587,19603,20730,21961,23279,
     J  24661,26083,27520,28955,30375,31774,33145,34486,35792,37060,
     K  38283,39454,40570,41629,42628,43568,44447,45261,46004,46670,
     L  47250,47737,48127,48416,48606,48703,48713,48649,48522,48344,
     M  48122,47866,47585,47287,46978,46663,46346,46028,45711,45397,
     N  45084,44775,44470,44167,43867,43569,43275,42985,42701,42424,
     O  42156,41897,41646,41405,41174,40952,40739,40536,40339,40150,
     P  39966,39789,39617,39453,39295,39144,38998,38855,38715,38578,
     Q  38443,38310,38179,38052,37927,37807,37690,37579,37473,37372,
     R  37274,37180,37089,36997,36906,36813,36719,36623,36526,36430/
      DATA NRH2O3/  !      (Nr - 1)*100000 from 3.80 - 4.99 microns
     A  36335,36244,36159,36080,36006,35936,35866,35798,35727,35654,
     B  35580,35504,35428,35353,35281,35210,35142,35079,35021,34967,
     C  34915,34865,34816,34768,34720,34671,34623,34575,34527,34479,
     D  34432,34385,34339,34294,34249,34202,34152,34101,34048,33994,
     E  33940,33886,33830,33774,33717,33661,33604,33551,33500,33452,
     F  33408,33366,33328,33291,33255,33219,33184,33149,33115,33083,
     G  33055,33029,33006,32986,32968,32953,32938,32924,32910,32894,
     H  32875,32854,32831,32807,32784,32761,32741,32724,32713,32706,
     I  32702,32700,32695,32690,32682,32672,32659,32643,32626,32608,
     J  32590,32573,32556,32542,32529,32517,32508,32502,32499,32500,
     K  32501,32503,32502,32498,32491,32481,32467,32449,32426,32401,
     L  32373,32345,32318,32289,32260,32231,32209,32193,32174,32140/
      DATA NIH2O1/  !     -log10(Ni)*10000 from 0.20 - 1.99 microns
     A  69590,71220,72560,73510,74190,74750,75360,75970,76610,77270,
     B  77960,78610,79300,80060,80920,81870,82910,84010,85150,86280,
     C  87300,88040,88620,89120,89570,89910,90140,90270,90300,90210,
     D  90000,89590,89080,88520,87890,87080,86200,85080,83430,81440,
     E  79630,78950,78620,78400,78130,77849,77410,76850,76290,75650,
     F  74325,73139,71374,69413,67860,67688,67618,67618,67772,68100,
     G  68447,68509,68158,66720,65796,65468,65159,64807,64321,63826,
     H  63387,62878,62006,60426,58636,56613,54720,54311,54243,54470,
     I  54895,55475,56163,56994,57811,58547,59027,59209,59063,58528,
     J  57804,57091,56486,55222,52683,50521,49669,49485,49345,49214,
     K  49148,49170,49285,49334,49429,49547,49591,49618,49432,49120,
     L  48659,48012,47196,46307,45445,44656,44082,43359,42039,39856,
     M  37346,35832,35070,34588,34337,34232,34219,34445,34820,35274,
     N  35802,36332,36874,37323,37822,38311,38763,39164,39476,39797,
     O  40067,40294,40496,40663,40822,40919,41012,41062,41080,41054,
     P  40990,40903,40729,40523,40252,39895,39567,39181,38950,38833,
     Q  38815,38789,38754,38660,38439,37991,37091,35500,33157,30531,
     R  28441,27376,26932,26780,26845,27068,27418,27807,28232,28673/ 
      DATA NIH2O2/  !     -log10(Ni)*10000 from 2.00 - 3.79 microns
     A  29101,29550,29952,30374,30773,31126,31524,31914,32255,32585,
     B  32907,33196,33464,33697,33908,34091,34230,34349,34429,34495,
     C  34521,34525,34497,34431,34340,34232,34076,33903,33696,33460,
     D  33214,32945,32654,32364,32021,31640,31441,31125,30813,30506,
     E  30192,29878,29556,29232,28930,28575,28183,27837,27515,27216, 
     F  26990,26930,26870,26800,26720,26610,26480,26380,26270,26160,
     G  26000,25720,25140,24210,23540,22910,22030,21070,19920,18800,
     H  18060,17310,16370,14570,13350,12320,11440,10780,10220, 9680,
     I   9210, 8780, 8340, 7901, 7490, 7090, 6760, 6490, 6260, 6040,
     J   5870, 5730, 5620, 5550, 5510, 5500, 5500, 5560, 5620, 5700,
     K   5790, 5910, 6010, 6140, 6270, 6440, 6610, 6780, 6960, 7210,
     L   7470, 7730, 8020, 8289, 8570, 8880, 9170, 9450, 9800,10190,
     M  10520,10870,11230,11610,11990,12330,12700,13040,13390,13780,
     N  14150,14550,14941,15210,15450,15680,15890,16120,16460,16780,
     O  17110,17429,17730,18030,18340,18660,18930,19219,19480,19760,
     P  20030,20290,20590,20840,21130,21430,21690,22010,22270,22520,
     Q  22760,22960,23190,23380,23550,23730,23880,24020,24150,24250,
     R  24360,24450,24520,24590,24660,24710,24750,24740,24750,24740/
      DATA NIH2O3/  !     -log10(Ni)*10000 from 3.80 - 4.99 microns
     A  24710,24690,24670,24590,24560,24500,24410,24350,24290,24230,
     B  24150,24070,24000,23930,23850,23770,23700,23610,23510,23410,
     C  23330,23240,23160,23080,22990,22900,22800,22710,22620,22530,
     D  22440,22360,22270,22180,22080,21990,21910,21830,21750,21670,
     E  21590,21500,21410,21320,21230,21130,21040,20970,20890,20810,
     F  20720,20640,20550,20470,20390,20310,20220,20130,20050,19960,
     G  19870,19790,19710,19620,19540,19450,19360,19260,19170,19100,
     H  19030,18950,18870,18790,18700,18630,18570,18510,18441,18370,
     I  18310,18260,18220,18180,18150,18130,18100,18080,18060,18050,
     J  18040,18040,18040,18040,18040,18060,18091,18110,18140,18160,
     K  18190,18220,18260,18290,18320,18350,18380,18420,18450,18490,
     L  18530,18570,18610,18650,18710,18760,18810,18870,18910,18950/   
C
      DIMENSION MNRH2O(400),MNIH2O(400)
      DIMENSION MRH2O1(150),MRH2O2(150),MRH2O3(100)
      DIMENSION MIH2O1(150),MIH2O2(150),MIH2O3(100)  
      EQUIVALENCE (MNRH2O(  1),MRH2O1(1)),(MNRH2O(151),MRH2O2(1))
      EQUIVALENCE (MNRH2O(301),MRH2O3(1)),(MNIH2O(  1),MIH2O1(1))
      EQUIVALENCE (MNIH2O(151),MIH2O2(1)),(MNIH2O(301),MIH2O3(1)) 
      DATA MRH2O1/  !              (Nr)*10000 from 5.0 - 750.0 cm-1
     A  26000,26000,25630,22250,21687,21500,21280,21100,20894,20700,
     B  20539,20400,20289,20200,20144,20100,20046,20000,19988,19970,
     C  19906,19820,19719,19600,19455,19290,19101,18900,18694,18480,
     D  18252,18010,17741,17460,17172,16890,16635,16400,16191,16000,
     E  15827,15670,15534,15420,15338,15280,15255,15250,15267,15290,
     F  15306,15320,15330,15340,15355,15370,15381,15390,15400,15410,
     G  15419,15430,15444,15460,15481,15500,15512,15520,15521,15520,
     H  15522,15520,15507,15490,15471,15450,15430,15410,15391,15370,
     I  15346,15320,15296,15270,15241,15210,15179,15150,15125,15100,
     J  15072,15040,15001,14960,14920,14880,14841,14800,14750,14700,
     K  14661,14620,14566,14510,14459,14410,14361,14310,14251,14190,
     L  14129,14070,14014,13960,13906,13850,13785,13720,13665,13610,
     M  13546,13480,13414,13350,13294,13240,13184,13130,13082,13030,
     N  12961,12890,12829,12770,12707,12640,12565,12490,12424,12360,
     O  12293,12230,12179,12130,12071,12010,11947,11890,11854,11820/
      DATA MRH2O2/  !           (Nr)*10000 from 755.0 - 1500.0 cm-1
     A  11769,11710,11642,11570,11489,11420,11394,11380,11360,11340,
     B  11318,11300,11297,11300,11311,11320,11316,11310,11314,11320,
     C  11319,11320,11333,11350,11369,11390,11409,11430,11458,11490,
     D  11525,11560,11591,11620,11650,11680,11709,11740,11774,11810,
     E  11851,11890,11915,11940,11979,12020,12051,12080,12110,12140,
     F  12171,12200,12220,12240,12270,12300,12321,12340,12360,12380,
     G  12400,12420,12441,12460,12475,12490,12510,12530,12545,12560,
     H  12576,12590,12600,12610,12625,12640,12656,12670,12681,12690,
     I  12700,12710,12725,12740,12750,12760,12775,12790,12800,12810,
     J  12820,12830,12840,12850,12855,12860,12869,12880,12895,12910,
     K  12921,12930,12936,12940,12945,12950,12954,12960,12969,12980,
     L  12991,13000,13006,13010,13015,13020,13024,13030,13040,13050,
     M  13056,13060,13065,13070,13075,13080,13085,13090,13095,13100,
     N  13104,13110,13120,13130,13136,13140,13145,13150,13155,13160,
     O  13165,13170,13175,13180,13185,13190,13194,13200,13209,13220/
      DATA MRH2O3/  !          (Nr)*10000 from 1505.0 - 2000.0 cm-1
     A  13230,13240,13249,13260,13279,13300,13315,13330,13350,13370,
     B  13390,13410,13429,13450,13475,13500,13521,13540,13553,13560,
     C  13554,13540,13521,13484,13410,13320,13217,13107,12999,12888,
     D  12767,12651,12550,12470,12430,12410,12406,12410,12412,12420,
     E  12443,12470,12490,12510,12534,12559,12590,12620,12646,12670,
     F  12690,12710,12731,12750,12765,12780,12800,12820,12836,12850,
     G  12865,12880,12895,12910,12925,12940,12955,12970,12980,12990,
     H  13005,13020,13031,13040,13050,13060,13070,13080,13090,13100,
     I  13105,13110,13120,13130,13135,13140,13150,13160,13166,13170,
     J  13175,13180,13180,13180,13185,13190,13195,13200,13205,13210/
      DATA MIH2O1/  !        -log10(Ni)*10000 from 5.0 - 750.0 cm-1
     A   -432, -373,  436, 1439, 2179, 2782, 3141, 3372, 3515, 3585,
     B   3571, 3526, 3502, 3468, 3399, 3316, 3222, 3125, 3038, 2950,
     C   2847, 2741, 2638, 2541, 2460, 2388, 2326, 2269, 2214, 2161,
     D   2108, 2062, 2028, 2013, 2041, 2090, 2159, 2240, 2331, 2434,
     E   2554, 2684, 2822, 2967, 3126, 3288, 3452, 3605, 3726, 3830,
     F   3920, 4001, 4077, 4145, 4206, 4260, 4302, 4342, 4385, 4425,
     G   4451, 4473, 4500, 4522, 4534, 4535, 4513, 4485, 4467, 4449,
     H   4426, 4401, 4371, 4342, 4318, 4295, 4266, 4237, 4207, 4179,
     I   4156, 4134, 4112, 4089, 4066, 4045, 4029, 4012, 3990, 3969,
     J   3952, 3936, 3915, 3893, 3877, 3862, 3841, 3820, 3803, 3788,
     K   3772, 3757, 3746, 3737, 3726, 3716, 3710, 3706, 3700, 3696,
     L   3696, 3696, 3690, 3686, 3689, 3696, 3705, 3716, 3726, 3737,
     M   3751, 3767, 3782, 3799, 3824, 3851, 3872, 3893, 3919, 3947,
     N   3980, 4012, 4040, 4067, 4099, 4134, 4174, 4214, 4248, 4283,
     O   4328, 4377, 4430, 4486, 4541, 4597, 4653, 4711, 4774, 4841/
      DATA MIH2O2/  !     -log10(Ni)*10000 from 755.0 - 1500.0 cm-1
     A   4913, 4990, 5071, 5157, 5248, 5347, 5456, 5575, 5709, 5850,
     B   5995, 6145, 6298, 6459, 6637, 6819, 6992, 7168, 7351, 7546,
     C   7763, 7986, 8201, 8416, 8639, 8862, 9073, 9281, 9494, 9706,
     D   9917,10119,10297,10469,10645,10821,10995,11168,11340,11505,
     E  11656,11799,11933,12061,12181,12299,12423,12541,12638,12725,
     F  12805,12882,12960,13037,13109,13179,13243,13306,13374,13439,
     G  13490,13536,13580,13625,13677,13726,13764,13798,13830,13862,
     H  13893,13925,13963,14002,14036,14067,14096,14123,14145,14168,
     I  14197,14225,14249,14271,14295,14318,14342,14365,14391,14413,
     J  14420,14425,14436,14449,14466,14485,14512,14535,14544,14547,
     K  14548,14547,14545,14547,14557,14572,14591,14609,14617,14622,
     L  14627,14635,14648,14660,14661,14660,14660,14660,14660,14660,
     M  14660,14660,14653,14647,14653,14660,14660,14660,14660,14660,
     N  14656,14647,14628,14609,14603,14597,14579,14560,14547,14534,
     O  14516,14498,14486,14473,14456,14437,14419,14401,14384,14365/
      DATA MIH2O3/  !    -log10(Ni)*10000 from 1505.0 - 2000.0 cm-1
     A  14341,14318,14304,14283,14233,14168,14090,13999,13887,13765,
     B  13638,13499,13337,13156,12952,12718,12427,12096,11709,11308,
     C  10937,10559,10123, 9705, 9351, 9065, 8890, 8793, 8787, 8864,
     D   9061, 9317, 9591, 9909,10313,10748,11174,11620,12117,12634,
     E  13150,13677,14262,14790,15074,15324,15730,16159,16539,16877,
     F  17118,17331,17568,17803,18027,18239,18429,18606,18774,18932,
     G  19079,19209,19307,19396,19493,19584,19649,19707,19770,19828,
     H  19873,19913,19960,20001,20015,20022,20035,20044,20040,20031,
     I  20017,19999,19981,19958,19918,19873,19832,19787,19726,19667,
     J  19630,19586,19492,19394,19334,19279,19209,19137,19064,18996/ 
C            
      DATA IFIRST/1/                                            
C 
C     Initialize:
C               WAVLEN,WAVNUM and XNRH2O,XNIH2O,XNLH2O spectral data
C     --------------------------------------------------------------
C
      IF(IFIRST.EQ.1) THEN
      DO 110 I=1,480
      WAVLEN(I)=0.2D0+(I-1)*0.01D0  
      XNRH2O(I)=1.D0+NNRH2O(I)/100000.D0
      XNLH2O(I)=-NNIH2O(I)/10000.D0
      XNIH2O(I)=10.D0**XNLH2O(I)
      WAVNUM(I)=10000.D0/WAVLEN(I)  
  110 CONTINUE
      J=480
      DO 120 II=1,400
      I=401-II
      J=J+1
      WAVN=2005.D0-II*5 
      WAVLEN(J)=10000.D0/WAVN 
      XNRH2O(J)=MNRH2O(I)/10000.D0
      XNLH2O(J)=-MNIH2O(I)/10000.D0
      XNIH2O(J)=10.D0**XNLH2O(J) 
      WAVNUM(J)=WAVN    
  120 CONTINUE 
      IFIRST=0
      ENDIF
C 
      IF(WAVL.GT.5.0) THEN
      WW=2000.D0/WAVL
      ELSE
      WW=(WAVL-0.2D0)*100.D0+1.D0
      ENDIF
      IW=WW  
      WTJ=WW-IW
      IF(IW.LT.1) IW=1
      JW=IW+1  
      IF(WAVL.GT.5.0) THEN   
      WTJ=1.D0-WTJ
      IW=880-IW
      JW=IW+1
      ENDIF 
      WTI=1.D0-WTJ
      XNR=WTI*XNRH2O(IW)+WTJ*XNRH2O(JW)
      XNL=WTI*XNLH2O(IW)+WTJ*XNLH2O(JW)
      XNI=10.D0**XNL
      RETURN
      END 


      SUBROUTINE AMMSO4(RH,WAVL,XNR,XNI)
      IMPLICIT REAL*8 (A-H,O-Z)  
      COMMON/MRICOM/XNRH2O(880),XNRSO4(880),XNRNO3(880),XNRSEA(880)
     A             ,XNIH2O(880),XNISO4(880),XNINO3(880),XNISEA(880)
     B             ,XNLH2O(880),XNLSO4(880),XNLNO3(880),XNLSEA(880)
     C             ,WAVLEN(880),RHRSO4(880),RHRNO3(880),RHRSEA(880)  
     D             ,WAVNUM(880),RHISO4(880),RHINO3(880),RHISEA(880) 
     E                         ,RHLSO4(880),RHLNO3(880),RHLSEA(880) 

!f2py intent(in) rh, wavl    
!f2py intent(out) xnr, xni

C
C-----------------------------------------------------------------------
C     AMMSO4  Real and imaginary refractive indices for Ammonium Sulfate
C
C     Input:   WAVL  Wavelength in microns (between 0.2 to 2000 microns)
C
C     Output:  XNR, XNI  Real and imaginary refractive index 
C          
C              Also available in COMMON/MRICOM/, the spectral dependence
C              of real (XNRSO4) and imaginary (XNISO4) refaractive index
C              from 0.2 to 2000 microns (0.01 increment 0.2-5.0 microns)
C              from 5 to 2000 microns: (5 cm-1 increment 2000 to 5 cm-1)
C              Wavelength is given in WAVLEN (microns) and WAVNUM (cm-1)
C
C              Spectral interpolation is linear for XNR, linear in log10
C              for XNI using XNLSO4 which is log10(XNI) in COMMON/MRICOM
C-----------------------------------------------------------------------
C     Remarks:
C              The refractive indices of dry Ammonium Sulfate are 
C              smoothly interpolated from data tabulated by:        
C
C              Toon et al  (1976) JGR 81, 5733-5748  (Table 5)
C
C              T76 value  Ni=1.E-07 from 0.2 to 0.8 mm is an upper limit
C              Spectral extrapolation is used outside 0.3 to 40 mm range  
C
C              Crystalization point is RHC=0.38 (Nr,Ni=dry for RH < RHC)
C-----------------------------------------------------------------------
C  
      DIMENSION NNRSO4(480),NNISO4(480) 
      DIMENSION NRSO41(180),NRSO42(180),NRSO43(120)
      DIMENSION NISO41(180),NISO42(180),NISO43(120)  
      EQUIVALENCE (NNRSO4(  1),NRSO41(1)),(NNRSO4(181),NRSO42(1))
      EQUIVALENCE (NNRSO4(361),NRSO43(1)),(NNISO4(  1),NISO41(1))
      EQUIVALENCE (NNISO4(181),NISO42(1)),(NNISO4(361),NISO43(1)) 
      DATA NRSO41/  !           (Nr)*10000 from 0.20 - 1.99 microns
     A  15650,15632,15615,15599,15583,15568,15553,15539,15525,15513,
     B  15501,15490,15479,15469,15458,15448,15438,15429,15420,15411,
     C  15403,15394,15386,15378,15370,15362,15354,15347,15339,15332,
     D  15326,15320,15314,15309,15303,15298,15293,15288,15283,15278,
     E  15273,15269,15265,15261,15257,15253,15250,15246,15242,15238,
     F  15235,15231,15227,15223,15220,15216,15212,15209,15205,15201,
     G  15197,15193,15190,15186,15182,15179,15175,15171,15167,15164,
     H  15160,15156,15152,15149,15145,15141,15137,15134,15130,15126,
     I  15123,15119,15115,15111,15108,15104,15100,15096,15093,15089,
     J  15085,15081,15078,15074,15070,15067,15063,15059,15055,15052,
     K  15048,15044,15040,15037,15033,15029,15025,15022,15018,15014,
     L  15010,15007,15003,14999,14995,14992,14988,14984,14981,14977,
     M  14973,14969,14966,14962,14958,14954,14951,14947,14943,14939,
     N  14936,14932,14928,14925,14921,14917,14913,14910,14906,14902,
     O  14898,14895,14891,14887,14883,14880,14876,14872,14869,14865,
     P  14861,14856,14852,14848,14844,14840,14836,14832,14828,14824,
     Q  14820,14816,14812,14808,14803,14799,14794,14789,14785,14781,
     R  14776,14771,14767,14762,14757,14753,14748,14744,14739,14734/
      DATA NRSO42/  !           (Nr)*10000 from 2.00 - 3.79 microns
     A  14730,14725,14720,14715,14710,14705,14700,14695,14690,14685,
     B  14680,14675,14670,14665,14660,14655,14650,14645,14640,14635,
     C  14630,14624,14618,14612,14606,14600,14594,14588,14582,14576,
     D  14570,14563,14556,14549,14542,14535,14528,14521,14514,14507,
     E  14499,14490,14480,14470,14460,14450,14440,14430,14420,14410,
     F  14399,14387,14376,14363,14351,14339,14327,14315,14303,14291,
     G  14280,14269,14258,14246,14233,14218,14202,14185,14168,14151,
     H  14134,14117,14100,14081,14061,14039,14017,13994,13970,13944,
     I  13916,13885,13852,13817,13780,13740,13697,13651,13602,13552,
     J  13502,13451,13397,13340,13279,13216,13150,13085,13020,12957,
     K  12897,12842,12794,12757,12727,12704,12685,12679,12705,12788,
     L  12951,13201,13519,13868,14200,14480,14689,14826,14898,14921,
     M  14907,14874,14839,14818,14821,14853,14922,15032,15187,15381,
     N  15594,15798,15966,16082,16145,16166,16161,16144,16122,16097,
     O  16071,16045,16023,16008,16004,16013,16033,16062,16097,16134,
     P  16170,16204,16233,16257,16275,16288,16295,16297,16294,16284,
     Q  16270,16252,16230,16206,16179,16151,16121,16091,16058,16025,
     R  15990,15955,15922,15889,15859,15829,15801,15775,15749,15724/
      DATA NRSO43/  !           (Nr)*10000 from 3.80 - 4.99 microns
     A  15700,15677,15654,15632,15612,15595,15580,15566,15554,15542,
     B  15531,15520,15510,15500,15490,15480,15470,15460,15450,15440,
     C  15430,15420,15410,15400,15390,15380,15370,15360,15350,15340,
     D  15330,15320,15310,15300,15290,15280,15270,15260,15250,15240,
     E  15230,15220,15210,15200,15190,15181,15172,15163,15155,15147,
     F  15138,15128,15118,15108,15099,15091,15083,15075,15068,15061,
     G  15054,15047,15040,15032,15025,15018,15010,15003,14995,14988,
     H  14980,14972,14964,14956,14948,14940,14932,14924,14916,14908,
     I  14900,14893,14886,14879,14872,14865,14858,14851,14844,14837,
     J  14830,14823,14816,14809,14803,14796,14790,14784,14778,14772,
     K  14766,14760,14754,14748,14742,14736,14730,14724,14718,14711,
     L  14704,14697,14690,14683,14676,14669,14661,14653,14645,14637/
      DATA NISO41/  !     -log10(Ni)*10000 from 0.20 - 1.99 microns
     A  70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,
     B  70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,
     C  70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,
     D  70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,
     E  70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,
     F  70000,70000,70000,70000,70000,70000,70000,70000,70000,70000,
     G  70000,69970,69920,69840,69760,69670,69570,69470,69360,69240,
     H  69110,68970,68820,68650,68450,68180,67810,67300,66600,65690,
     I  64559,63140,61590,60000,58520,57320,56530,56498,56430,57010,
     J  57800,58640,59400,59960,60250,60223,59690,58790,57580,56160,
     K  54685,53370,52180,51160,50280,49520,48870,48350,47970,47760,
     L  47696,47770,47960,48230,48560,48890,49180,49410,49560,49620,
     M  49586,49510,49330,49070,48740,48340,47880,47330,46640,45770,
     N  44685,43310,41830,40380,39090,38060,37330,36920,36778,36930,
     O  37212,37530,37860,38200,38540,38880,39220,39560,39880,40190,
     P  40458,40670,40830,40960,41060,41150,41220,41270,41300,41270,
     Q  41192,41060,40890,40700,40480,40240,39960,39620,39210,38750,
     R  38239,37750,37200,36570,35870,35120,34310,33430,32440,31300/
      DATA NISO42/  !     -log10(Ni)*10000 from 2.00 - 3.79 microns
     A  30000,29684,29350,29002,28636,28239,27790,27286,26740,26180,
     B  25642,25178,24838,24664,24685,24952,25386,25938,26542,27140,
     C  27696,28160,28570,28942,29290,29620,29942,30254,30556,30850,
     D  31135,31416,31686,31946,32196,32436,32664,32882,33088,33282,
     E  33468,33650,33826,33996,34158,34308,34436,34534,34594,34604,
     F  34559,34450,34282,34064,33800,33500,33172,32820,32448,32064,
     G  31670,31272,30868,30458,30040,29610,29166,28710,28238,27754,
     H  27260,26756,26242,25722,25194,24660,24120,23572,23010,22432,
     I  21836,21224,20594,19952,19300,18642,17984,17326,16672,16024,
     J  15388,14764,14160,13576,13010,12466,11934,11414,10900,10394,
     K   9896, 9408, 8934, 8472, 8028, 7600, 7186, 6782, 6383, 5964,
     L   5566, 5220, 4960, 4815, 4850, 4992, 5208, 5450, 5686, 5864,
     M   6006, 6110, 6178, 6198, 6158, 6070, 5948, 5822, 5720, 5670,
     N   5686, 5800, 5974, 6198, 6444, 6712, 6986, 7250, 7490, 7696,
     O   7852, 7972, 8062, 8134, 8192, 8239, 8270, 8294, 8318, 8356,
     P   8426, 8539, 8714, 8936, 9188, 9458, 9730,10000,10254,10504,
     Q  10752,11002,11254,11508,11764,12020,12276,12532,12788,13042,
     R  13294,13544,13792,14036,14278,14516,14750,14978,15202,15420/
      DATA NISO43/  !     -log10(Ni)*10000 from 3.80 - 4.99 microns
     A  15632,15838,16036,16226,16406,16576,16732,16878,17014,17140,
     B  17260,17374,17480,17582,17678,17768,17854,17936,18012,18086,
     C  18156,18224,18288,18350,18410,18470,18528,18586,18644,18700,
     D  18758,18818,18878,18940,19004,19070,19138,19208,19280,19352,
     E  19422,19494,19564,19636,19706,19776,19844,19914,19982,20050,
     F  20118,20184,20250,20316,20382,20446,20510,20572,20634,20696,
     G  20756,20816,20876,20934,20992,21048,21102,21156,21210,21262,
     H  21314,21364,21412,21460,21504,21549,21592,21632,21672,21710,
     I  21748,21786,21822,21858,21892,21926,21958,21990,22020,22050,
     J  22078,22104,22130,22156,22178,22200,22218,22234,22248,22258,
     K  22266,22272,22276,22280,22280,22280,22278,22274,22268,22262,
     L  22254,22244,22234,22222,22210,22196,22180,22166,22148,22130/
C
      DIMENSION MNRSO4(400),MNISO4(400)
      DIMENSION MRSO41(150),MRSO42(150),MRSO43(100)
      DIMENSION MISO41(150),MISO42(150),MISO43(100)  
      EQUIVALENCE (MNRSO4(  1),MRSO41(1)),(MNRSO4(151),MRSO42(1))
      EQUIVALENCE (MNRSO4(301),MRSO43(1)),(MNISO4(  1),MISO41(1))
      EQUIVALENCE (MNISO4(151),MISO42(1)),(MNISO4(301),MISO43(1)) 
      DATA MRSO41/  !              (Nr)*10000 from 5.0 - 750.0 cm-1
     A   9545, 9863,10276,10757,11283,11826,12362,12865,13309,13671,
     B  13957,14232,14497,14753,15000,15237,15466,15686,15897,16100,
     C  16282,16449,16607,16763,16920,17086,17260,17432,17602,17773,
     D  17945,18121,18301,18488,18683,18887,19101,19328,19569,19827,
     E  20183,20637,21136,21626,22055,22369,22514,22437,22158,21400,
     F  20084,17981,16135,14869,13878,13114,12528,12071,11815,11800,
     G  11850,12000,12200,12500,12832,13166,13440,13700,14000,14200,
     H  14385,14544,14691,14827,14953,15072,15185,15293,15397,15500,
     I  15591,15673,15748,15816,15880,15942,16002,16063,16127,16194,
     J  16263,16333,16402,16471,16540,16610,16681,16753,16826,16900,
     K  16970,17040,17110,17180,17250,17345,17440,17535,17630,17726,
     L  17820,17925,18042,18169,18400,18680,19080,19600,20500,21830,
     M  27522,27720,17602, 7400, 7600, 8800,11000,13000,14250,14800,
     N  15000,15190,15375,15528,15700,15820,15940,16060,16180,16300,
     O  16416,16503,16580,16648,16709,16765,16818,16870,16922,16978/
      DATA MRSO42/  !           (Nr)*10000 from 755.0 - 1500.0 cm-1
     A  17036,17090,17142,17193,17242,17291,17341,17392,17445,17500,
     B  17559,17620,17682,17745,17809,17874,17939,18004,18068,18132,
     C  18194,18254,18313,18373,18433,18496,18561,18631,18705,18785,
     D  18872,18959,19047,19137,19232,19333,19441,19558,19687,19828,
     E  19986,20147,20310,20479,20658,20854,21071,21315,21589,21900,
     F  22283,22711,23175,23667,24179,24704,25232,25756,26268,26760,
     G  27422,28246,28771,28506,26999,24787,22242,19739,17240,14547,
     H  11979, 9861, 8529, 7666, 7147, 6849, 6646, 6415, 6293, 6346,
     I   6545, 6863, 7276, 7757, 8283, 8826, 9362, 9865,10309,10671,
     J  10957,11232,11497,11753,12000,12237,12466,12686,12897,13100,
     K  13282,13449,13607,13763,13920,14086,14260,14432,14602,14773,
     L  14945,15121,15301,15488,15683,15887,16101,16328,16569,16827,
     M  17183,17637,18136,18626,19055,19369,19514,19437,19158,18605,
     N  17084,14981,13135,11869,10878,10114, 9528, 9071, 8695, 8367,
     O   8252, 8316, 8523, 8840, 9232, 9666,10107,10521,10874,11130/
      DATA MRSO43/   !         (Nr)*10000 from 1505.0 - 2000.0 cm-1
     A  11318,11490,11645,11786,11914,12029,12133,12227,12312,12389,
     B  12460,12526,12588,12646,12703,12759,12816,12874,12935,13000,
     C  13059,13114,13164,13211,13254,13294,13331,13366,13398,13428,
     D  13457,13485,13511,13537,13562,13588,13614,13640,13667,13696,
     E  13724,13750,13776,13801,13826,13849,13872,13894,13916,13936,
     F  13957,13976,13996,14014,14032,14050,14067,14084,14100,14116,
     G  14131,14146,14161,14176,14191,14205,14219,14233,14247,14261,
     H  14274,14288,14301,14315,14328,14342,14355,14369,14383,14397,
     I  14410,14423,14436,14449,14462,14474,14486,14498,14510,14522,
     J  14533,14545,14556,14567,14578,14588,14599,14609,14619,14629/
      DATA MISO41/  !        -log10(Ni)*10000 from 5.0 - 750.0 cm-1
     A   2464, 3142, 3835, 4531, 5221, 5894, 6538, 7144, 7700, 8195,
     B   8603, 8972, 9309, 9615, 9894,10148,10380,10592,10788,10969,
     C  11119,11253,11367,11457,11519,11548,11523,11478,11414,11327,
     D  11214,11071,10897,10686,10436,10144, 9807, 9421, 8983, 8485,
     E   7882, 7226, 6524, 5781, 5001, 4002, 3059, 1907,  877, -500,
     F   -250,  -20,  310,  700, 1070, 1482, 1919, 2378, 2853, 3343,
     G   3890, 4496, 5144, 5819, 6507, 7193, 7861, 8499, 9090, 9619,
     H  10068,10480,10860,11213,11543,11855,12153,12441,12726,13010,
     I  13276,13526,13762,13987,14202,14411,14613,14813,15011,15211,
     J  15411,15615,15821,16025,16223,16411,16585,16742,16878,16990,
     K  17083,17194,17308,17410,17486,17521,17499,17408,17231,16949,
     L  16709,16036,15424,14867,14259,13592,12761,11859,10681, 9314,
     M   6595, 2033,-3333,-1272, 1064, 3921, 7112,10316,13211,15444,
     N  15810,16200,16480,16598,16688,16755,16828,16866,16900,16928,
     O  16940,16950,16957,16964,16970,16977,16979,16982,16985,16988/
      DATA MISO42/  !     -log10(Ni)*10000 from 755.0 - 1500.0 cm-1
     A  16990,16992,16993,16994,16995,16996,16997,16998,16999,17000,
     B  17000,17000,17000,17000,16990,16970,16940,16905,16845,16785,
     C  16705,16458,16175,15867,15542,15212,14885,14571,14280,14022,
     D  13810,13630,13472,13328,13190,13052,12904,12741,12554,12336,
     E  12074,11788,11490,11177,10846,10496,10125, 9730, 9309, 8861,
     F   8372, 7877, 7370, 6841, 6285, 5694, 5060, 4376, 3634, 2828,
     G   1881,  842, -171,-1040,-1757,-2392,-2891,-3202,-3200,-2978,
     H  -2644,-2295,-1908,-1460, -967, -445,   92,  628, 1196, 1812,
     I   2464, 3142, 3835, 4531, 5221, 5894, 6538, 7144, 7700, 8195,
     J   8603, 8972, 9309, 9615, 9894,10148,10380,10592,10788,10969,
     K  11119,11253,11367,11457,11519,11548,11523,11478,11414,11327,
     L  11214,11071,10897,10686,10436,10144, 9807, 9421, 8983, 8485,
     M   7882, 7226, 6524, 5781, 5001, 4192, 3359, 2507, 1577,  686,
     N    113, -247, -412, -217,  257,  932, 1730, 2571, 3377, 4072,
     O   4724, 5392, 6069, 6750, 7427, 8094, 8746, 9375, 9975,10535/
      DATA MISO43/  !    -log10(Ni)*10000 from 1505.0 - 2000.0 cm-1
     A  11034,11505,11948,12366,12760,13132,13484,13817,14134,14435,
     B  14722,14998,15264,15522,15773,16019,16262,16504,16746,16990,
     C  17212,17422,17622,17811,17990,18161,18323,18478,18626,18767,
     D  18903,19040,19178,19316,19450,19563,19668,19774,19879,19984,
     E  20065,20139,20211,20277,20339,20399,20454,20506,20556,20601,
     F  20645,20685,20725,20762,20796,20825,20855,20885,20915,20945,
     G  20975,21005,21035,21064,21094,21124,21154,21184,21214,21244,
     H  21274,21303,21333,21363,21393,21423,21453,21483,21513,21543,
     I  21570,21597,21625,21653,21681,21709,21738,21767,21795,21824,
     J  21852,21880,21907,21935,21961,21987,22013,22037,22061,22112/
C 
      DATA CXMSO4/.7885632/, CRHSO4/.37/, CNRSO4/1.526/, CNRH2O/1.333/ 
C  
      DATA IFIRST/1/ 
C                                  
C-----------------------------------------------------------------------              
C     Tang & Munkelwitz (1994) JGR 99, 18801-18808      (water activity)
C     Tang & Munkelwitz (1991) Aer Sci & Tech 15, 201-207 (refrac index) 
C-----------------------------------------------------------------------              
C  
      AWSO4(X)=1.D0-0.2715D0*X+0.3113D0*X**2-2.336D0*X**3+1.412D0*X**4 
      DWSO4(X)=    -0.2715D0  +0.6226D0*X   -7.008D0*X**2+4.648D0*X**3 
      FNRSO4(X)=1.333D0+0.1673D0*X-0.0395D0*X**2                 !  TM91
C 
C     Initialize:
C                WAVLEN,WAVNUM and XNRSO4,XNISO4,XNLSO4 spectral data
C                Also calls WATER to initialize  XNRH2O,XNIH2O,XNLH2O 
C     ---------------------------------------------------------------
C    
      IF(IFIRST.EQ.1) THEN
      DO 110 I=1,480
      WAVLEN(I)=0.2D0+(I-1)*0.01D0  
      XNRSO4(I)=NNRSO4(I)/10000.D0
      XNLSO4(I)=-NNISO4(I)/10000.D0
      XNISO4(I)=10.D0**XNLSO4(I) 
      WAVNUM(I)=10000.D0/WAVLEN(I) 
  110 CONTINUE
      J=480
      DO 120 II=1,400
      I=401-II
      J=J+1
      WAVN=2005.D0-II*5
      WAVLEN(J)=10000.D0/WAVN 
      XNRSO4(J)=MNRSO4(I)/10000.D0
      XNLSO4(J)=-MNISO4(I)/10000.D0  
      XNISO4(J)=10.D0**XNLSO4(J) 
      WAVNUM(J)=WAVN      
  120 CONTINUE    
      WAV0=0.5
      CALL WATER(WAV0,XNR0,XNI0) 
      IFIRST=0
      ENDIF
C
C-----------------------------------------------------------------------
C     Newton-Raphson iteration is used to obtain mass fraction X for the
C     specified relative humidity RH using the T&M (1996) water activity 
C     formula determined at the HeNe laser wavelength of 0.633 microns.
C
C     Ammonium Sulfate solution refractive index for the mass fraction X  
C     is used to obtain a refractive index proportionality factor: WTSO4
C     to linearly interpolate the RH dependence of both real & imaginary 
C     refractive index between the (dry) Ammonium Sulfate and pure Water 
C     values - taken to apply for all other wavelengths of the spectrum.
C-----------------------------------------------------------------------
C
      WTSO4=1.0
      IF(RH.LT.CRHSO4) GO TO 140
      XM1=CXMSO4
      RH1=AWSO4(XM1)
      DM2=DWSO4(XM1)
      DO 130 I=1,10
      XM2=XM1+(RH-RH1)/DM2
      RH2=AWSO4(XM2)
      DM2=DWSO4(XM2)                                 
      DRH=RH-RH2       
      XM1=XM2
      RH1=RH2
  130 CONTINUE  
      RHXNR=FNRSO4(XM1)
      WTSO4=(RHXNR-CNRH2O)/(CNRSO4-CNRH2O) 
  140 CONTINUE  
      IF(RH.GT.0.999) WTSO4=0.0
      WTH2O=1.0-WTSO4
      DO 150 I=1,880
      RHRSO4(I)=WTH2O*XNRH2O(I)+WTSO4*XNRSO4(I)
      RHISO4(I)=WTH2O*XNIH2O(I)+WTSO4*XNISO4(I) 
      RHLSO4(I)=LOG10(RHISO4(I)) 
  150 CONTINUE       
C
      IF(WAVL.GT.5.0) THEN
      WW=2000.D0/WAVL
      ELSE
      WW=(WAVL-0.2D0)*100.D0+1.D0
      ENDIF
      IW=WW  
      WTJ=WW-IW
      IF(IW.LT.1) IW=1
      JW=IW+1  
      IF(WAVL.GT.5.0) THEN   
      WTJ=1.D0-WTJ
      IW=880-IW
      JW=IW+1
      ENDIF 
      WTI=1.D0-WTJ
      XNR=WTI*RHRSO4(IW)+WTJ*RHRSO4(JW)
      XNL=WTI*RHLSO4(IW)+WTJ*RHLSO4(JW)
      XNI=10.D0**XNL
      RETURN
      END     

      SUBROUTINE AMMNO3(RH,WAVL,XNR,XNI)
      IMPLICIT REAL*8 (A-H,O-Z)  
      COMMON/MRICOM/XNRH2O(880),XNRSO4(880),XNRNO3(880),XNRSEA(880)
     A             ,XNIH2O(880),XNISO4(880),XNINO3(880),XNISEA(880)
     B             ,XNLH2O(880),XNLSO4(880),XNLNO3(880),XNLSEA(880)
     C             ,WAVLEN(880),RHRSO4(880),RHRNO3(880),RHRSEA(880)  
     D             ,WAVNUM(880),RHISO4(880),RHINO3(880),RHISEA(880) 
     E                         ,RHLSO4(880),RHLNO3(880),RHLSEA(880) 

!f2py intent(in) rh, wavl    
!f2py intent(out) xnr, xni
C
C-----------------------------------------------------------------------
C     AMMNO3  Real and imaginary refractive indices for Ammonium Nitrate
C
C     Input:   WAVL  Wavelength in microns (between 0.2 to 2000 microns)
C
C     Output:  XNR, XNI  Real and imaginary refractive index 
C          
C              Also available in COMMON/MRICOM/, the spectral dependence
C              of real (XNRNO3) and imaginary (XNINO3) refaractive index
C              from 0.2 to 2000 microns (0.01 increment 0.2-5.0 microns)
C              from 5 to 2000 microns: (5 cm-1 increment 2000 to 5 cm-1)
C              Wavelength is given in WAVLEN (microns) and WAVNUM (cm-1)
C
C              Spectral interpolation is linear for XNR, linear in log10
C              for XNI using XNLNO3 which is log10(XNI) in COMMON/MRICOM
C-----------------------------------------------------------------------
C     Remarks:
C              The real part of dry Ammonium Nitrate refractive index is
C              spectrally extrapolated from water refractive index using
C              (real) refractive index proportionality measured at 0.633 
C              microns by
C                          Tang & Munkelwitz (1996) JGR 101, 19245-19250
C
C              The imaginary refractive index of dry Ammonium Nitrate is
C              linearly extrapolated from Ni measurements for a solution
C              of Ammonium Nitrate with mass fraction 0.4 by
C
C                              Gosse et al (1997) Appl Opt 36, 3622-3634
C
C              using TM96 proportionality for the 0.8 - 2.7 mm interval.
C
C              Outside of the measurement interval, the Ammonium Nitrate
C              imaginary refaractive index is assumed (by default) to be
C              the same as that for pure Water.                           
C      
C              Crystalization point is RHC=0.28 (Nr,Ni=dry for RH < RHC)
C-----------------------------------------------------------------------
C   
      DIMENSION NNRNO3(480),NNINO3(480) 
      DIMENSION NRNO31(180),NRNO32(180),NRNO33(120)
      DIMENSION NINO31(180),NINO32(180),NINO33(120)  
      EQUIVALENCE (NNRNO3(  1),NRNO31(1)),(NNRNO3(181),NRNO32(1))
      EQUIVALENCE (NNRNO3(361),NRNO33(1)),(NNINO3(  1),NINO31(1))
      EQUIVALENCE (NNINO3(181),NINO32(1)),(NNINO3(361),NINO33(1)) 
      DATA NRNO31/  !           (Nr)*10000 from 0.20 - 1.99 microns
     A  39600,38560,37724,37082,36583,36183,35854,35575,35333,35142,
     B  34971,34814,34670,34536,34414,34303,34202,34112,34033,33963, 
     C  33901,33847,33800,33760,33724,33693,33666,33641,33616,33592,
     D  33568,33545,33522,33500,33478,33457,33436,33416,33396,33377,
     E  33358,33340,33322,33305,33288,33271,33254,33237,33221,33205,
     F  33189,33174,33159,33144,33130,33116,33102,33088,33074,33061,
     G  33048,33035,33023,33011,32999,32987,32975,32963,32951,32939,
     H  32927,32915,32903,32891,32879,32867,32855,32843,32831,32819,
     I  32807,32795,32783,32771,32759,32747,32735,32722,32709,32696,
     J  32683,32669,32655,32641,32627,32613,32599,32585,32570,32556,
     K  32542,32527,32512,32496,32480,32464,32448,32432,32416,32400,
     L  32383,32367,32351,32334,32317,32299,32281,32263,32244,32225,
     M  32206,32186,32167,32148,32128,32109,32088,32068,32047,32027,
     N  32008,31989,31969,31950,31930,31910,31890,31868,31846,31823,
     O  31799,31774,31749,31723,31696,31668,31639,31610,31580,31550,
     P  31520,31490,31461,31432,31404,31377,31349,31323,31296,31269,
     Q  31243,31217,31191,31164,31140,31114,31089,31062,31036,31007,
     R  30978,30947,30914,30880,30845,30809,30770,30731,30689,30646/
      DATA NRNO32/  !           (Nr)*10000 from 2.00 - 3.79 microns
     A  30599,30550,30498,30442,30385,30325,30264,30202,30141,30079,
     B  30016,29953,29889,29823,29754,29683,29608,29530,29450,29367,
     C  29284,29201,29120,29039,28961,28882,28803,28722,28640,28555,
     D  28468,28380,28289,28197,28104,28011,27918,27822,27722,27616,
     E  27503,27381,27250,27114,26973,26829,26683,26536,26385,26231,
     F  26070,25901,25719,25523,25311,25081,24833,24568,24285,23983,
     G  23657,23305,22921,22501,22037,21518,20930,20263,19515,18696,
     H  17829,16953,16116,15230,14470,13980,13790,13890,14210,14670,
     I  15190,15730,16290,16872,17679,18587,19603,20730,21961,23279,
     J  24661,26083,27520,28955,30375,31774,33145,34486,35792,37060,
     K  38283,39454,40570,41629,42628,43568,44447,45261,46004,46670,
     L  47250,47737,48127,48416,48606,48703,48713,48649,48522,48344,
     M  48122,47866,47585,47287,46978,46663,46346,46028,45711,45397,
     N  45084,44775,44470,44167,43867,43569,43275,42985,42701,42424,
     O  42156,41897,41646,41405,41174,40952,40739,40536,40339,40150,
     P  39966,39789,39617,39453,39295,39144,38998,38855,38715,38578,
     Q  38443,38310,38179,38052,37927,37807,37690,37579,37473,37372,
     R  37274,37180,37089,36997,36906,36813,36719,36623,36526,36430/
      DATA NRNO33/  !           (Nr)*10000 from 3.80 - 4.99 microns
     A  36335,36244,36159,36080,36006,35936,35866,35798,35727,35654,
     B  35580,35504,35428,35353,35281,35210,35142,35079,35021,34967,
     C  34915,34865,34816,34768,34720,34671,34623,34575,34527,34479,
     D  34432,34385,34339,34294,34249,34202,34152,34101,34048,33994,
     E  33940,33886,33830,33774,33717,33661,33604,33551,33500,33452,
     F  33408,33366,33328,33291,33255,33219,33184,33149,33115,33083,
     G  33055,33029,33006,32986,32968,32953,32938,32924,32910,32894,
     H  32875,32854,32831,32807,32784,32761,32741,32724,32713,32706,
     I  32702,32700,32695,32690,32682,32672,32659,32643,32626,32608,
     J  32590,32573,32556,32542,32529,32517,32508,32502,32499,32500,
     K  32501,32503,32502,32498,32491,32481,32467,32449,32426,32401,
     L  32373,32345,32318,32289,32260,32231,32209,32193,32174,32140/
      DATA NINO31/ !      -log10(Ni)*10000 from 0.20 - 1.99 microns
     A  69590,71220,72560,73510,74190,74750,75360,75970,76610,77270,
     B  77960,78610,79300,80060,80920,81870,82910,84010,85150,86280,
     C  87300,88040,88620,89120,89570,89910,90140,90270,90300,90210,
     D  90000,89950,89900,89850,89800,89750,89700,89650,89600,89550,
     E  89500,89450,89400,89350,89300,89250,89200,89150,89100,89050,
     F  89000,88950,88900,88850,88800,88750,88700,88650,88600,88550,
     G  88500,88450,88400,77000,72360,73258,74688,75550,76440,77030,
     H  77308,72506,70879,68917,66250,64576,62712,56688,56661,57276,
     I  59337,61484,61178,59238,57782,56709,56276,56188,56350,56809,
     J  57244,57648,58438,59509,60827,60346,53153,51962,53421,55613,
     K  56623,56701,54716,54164,52703,51847,51130,50675,50587,50296,
     L  50086,49964,49815,49768,49826,49953,50168,51371,59440,61110,
     M  62120,62764,62748,62648,62360,62111,61820,61330,60220,59440,
     N  59020,57820,53820,45510,41797,39819,38611,38083,38108,38337,
     O  38731,39256,39658,40069,40473,41091,41645,42143,42585,43111,
     P  43706,43951,44131,43882,43478,43110,42693,42379,41571,40850,
     Q  40250,39934,39823,39689,39542,39372,39426,40577,41940,42500,
     R  38050,32369,29112,29066,30314,32287,33994,35251,35435,34134/ 
      DATA NINO32/ !      -log10(Ni)*10000 from 2.00 - 3.79 microns 
     A  32474,30975,29957,29241,28878,28721,28475,28113,27654,27076,
     B  26478,25965,25541,25306,25163,25162,25343,25649,26074,26527,
     C  26983,27435,27875,28353,28860,29389,29936,30442,30874,31228,
     D  31542,31878,32237,32506,32848,32916,32880,32757,32535,32204,
     E  31806,31349,30974,30619,30256,29900,29784,29584,29423,29276,
     F  28878,27925,27325,27010,26900,27002,27257,27402,27475,27314,
     G  27140,27105,28260,37944,42100,43440,43510,43030,42670,42220,
     H  18060,17310,16370,14570,13350,12320,11440,10780,10220, 9680,
     I   9210, 8780, 8340, 7901, 7490, 7090, 6760, 6490, 6260, 6040,
     J   5870, 5730, 5620, 5550, 5510, 5500, 5500, 5560, 5620, 5700,
     K   5790, 5910, 6010, 6140, 6270, 6440, 6610, 6780, 6960, 7210,
     L   7470, 7730, 8020, 8289, 8570, 8880, 9170, 9450, 9800,10190,
     M  10520,10870,11230,11610,11990,12330,12700,13040,13390,13780,
     N  14150,14550,14941,15210,15450,15680,15890,16120,16460,16780,
     O  17110,17429,17730,18030,18340,18660,18930,19219,19480,19760,
     P  20030,20290,20590,20840,21130,21430,21690,22010,22270,22520,
     Q  22760,22960,23190,23380,23550,23730,23880,24020,24150,24250,
     R  24360,24450,24520,24590,24660,24710,24750,24740,24750,24740/
      DATA NINO33/ !      -log10(Ni)*10000 from 3.80 - 4.99 microns
     A  24710,24690,24670,24590,24560,24500,24410,24350,24290,24230,
     B  24150,24070,24000,23930,23850,23770,23700,23610,23510,23410,
     C  23330,23240,23160,23080,22990,22900,22800,22710,22620,22530,
     D  22440,22360,22270,22180,22080,21990,21910,21830,21750,21670,
     E  21590,21500,21410,21320,21230,21130,21040,20970,20890,20810,
     F  20720,20640,20550,20470,20390,20310,20220,20130,20050,19960,
     G  19870,19790,19710,19620,19540,19450,19360,19260,19170,19100,
     H  19030,18950,18870,18790,18700,18630,18570,18510,18441,18370,
     I  18310,18260,18220,18180,18150,18130,18100,18080,18060,18050,
     J  18040,18040,18040,18040,18040,18060,18091,18110,18140,18160,
     K  18190,18220,18260,18290,18320,18350,18380,18420,18450,18490,
     L  18530,18570,18610,18650,18710,18760,18810,18870,18910,18950/   
C
      DIMENSION MNRNO3(400),MNINO3(400)
      DIMENSION MRNO31(150),MRNO32(150),MRNO33(100)
      DIMENSION MINO31(150),MINO32(150),MINO33(100)  
      EQUIVALENCE (MNRNO3(  1),MRNO31(1)),(MNRNO3(151),MRNO32(1))
      EQUIVALENCE (MNRNO3(301),MRNO33(1)),(MNINO3(  1),MINO31(1))
      EQUIVALENCE (MNINO3(151),MINO32(1)),(MNINO3(301),MINO33(1)) 
      DATA MRNO31/  !              (Nr)*10000 from 5.0 - 750.0 cm-1
     A  26000,26000,25630,22250,21687,21500,21280,21100,20894,20700,
     B  20539,20400,20289,20200,20144,20100,20046,20000,19988,19970,
     C  19906,19820,19719,19600,19455,19290,19101,18900,18694,18480,
     D  18252,18010,17741,17460,17172,16890,16635,16400,16191,16000,
     E  15827,15670,15534,15420,15338,15280,15255,15250,15267,15290,
     F  15306,15320,15330,15340,15355,15370,15381,15390,15400,15410,
     G  15419,15430,15444,15460,15481,15500,15512,15520,15521,15520,
     H  15522,15520,15507,15490,15471,15450,15430,15410,15391,15370,
     I  15346,15320,15296,15270,15241,15210,15179,15150,15125,15100,
     J  15072,15040,15001,14960,14920,14880,14841,14800,14750,14700,
     K  14661,14620,14566,14510,14459,14410,14361,14310,14251,14190,
     L  14129,14070,14014,13960,13906,13850,13785,13720,13665,13610,
     M  13546,13480,13414,13350,13294,13240,13184,13130,13082,13030,
     N  12961,12890,12829,12770,12707,12640,12565,12490,12424,12360,
     O  12293,12230,12179,12130,12071,12010,11947,11890,11854,11820/
      DATA MRNO32/  !           (Nr)*10000 from 755.0 - 1500.0 cm-1
     A  11769,11710,11642,11570,11489,11420,11394,11380,11360,11340,
     B  11318,11300,11297,11300,11311,11320,11316,11310,11314,11320,
     C  11319,11320,11333,11350,11369,11390,11409,11430,11458,11490,
     D  11525,11560,11591,11620,11650,11680,11709,11740,11774,11810,
     E  11851,11890,11915,11940,11979,12020,12051,12080,12110,12140,
     F  12171,12200,12220,12240,12270,12300,12321,12340,12360,12380,
     G  12400,12420,12441,12460,12475,12490,12510,12530,12545,12560,
     H  12576,12590,12600,12610,12625,12640,12656,12670,12681,12690,
     I  12700,12710,12725,12740,12750,12760,12775,12790,12800,12810,
     J  12820,12830,12840,12850,12855,12860,12869,12880,12895,12910,
     K  12921,12930,12936,12940,12945,12950,12954,12960,12969,12980,
     L  12991,13000,13006,13010,13015,13020,13024,13030,13040,13050,
     M  13056,13060,13065,13070,13075,13080,13085,13090,13095,13100,
     N  13104,13110,13120,13130,13136,13140,13145,13150,13155,13160,
     O  13165,13170,13175,13180,13185,13190,13194,13200,13209,13220/
      DATA MRNO33/  !          (Nr)*10000 from 1505.0 - 2000.0 cm-1
     A  13230,13240,13249,13260,13279,13300,13315,13330,13350,13370,
     B  13390,13410,13429,13450,13475,13500,13521,13540,13553,13560,
     C  13554,13540,13521,13484,13410,13320,13217,13107,12999,12888,
     D  12767,12651,12550,12470,12430,12410,12406,12410,12412,12420,
     E  12443,12470,12490,12510,12534,12559,12590,12620,12646,12670,
     F  12690,12710,12731,12750,12765,12780,12800,12820,12836,12850,
     G  12865,12880,12895,12910,12925,12940,12955,12970,12980,12990,
     H  13005,13020,13031,13040,13050,13060,13070,13080,13090,13100,
     I  13105,13110,13120,13130,13135,13140,13150,13160,13166,13170,
     J  13175,13180,13180,13180,13185,13190,13195,13200,13205,13210/
      DATA MINO31/  !        -log10(Ni)*10000 from 5.0 - 750.0 cm-1
     A   -432, -373,  436, 1439, 2179, 2782, 3141, 3372, 3515, 3585,
     B   3571, 3526, 3502, 3468, 3399, 3316, 3222, 3125, 3038, 2950,
     C   2847, 2741, 2638, 2541, 2460, 2388, 2326, 2269, 2214, 2161,
     D   2108, 2062, 2028, 2013, 2041, 2090, 2159, 2240, 2331, 2434,
     E   2554, 2684, 2822, 2967, 3126, 3288, 3452, 3605, 3726, 3830,
     F   3920, 4001, 4077, 4145, 4206, 4260, 4302, 4342, 4385, 4425,
     G   4451, 4473, 4500, 4522, 4534, 4535, 4513, 4485, 4467, 4449,
     H   4426, 4401, 4371, 4342, 4318, 4295, 4266, 4237, 4207, 4179,
     I   4156, 4134, 4112, 4089, 4066, 4045, 4029, 4012, 3990, 3969,
     J   3952, 3936, 3915, 3893, 3877, 3862, 3841, 3820, 3803, 3788,
     K   3772, 3757, 3746, 3737, 3726, 3716, 3710, 3706, 3700, 3696,
     L   3696, 3696, 3690, 3686, 3689, 3696, 3705, 3716, 3726, 3737,
     M   3751, 3767, 3782, 3799, 3824, 3851, 3872, 3893, 3919, 3947,
     N   3980, 4012, 4040, 4067, 4099, 4134, 4174, 4214, 4248, 4283,
     O   4328, 4377, 4430, 4486, 4541, 4597, 4653, 4711, 4774, 4841/
      DATA MINO32/  !     -log10(Ni)*10000 from 755.0 - 1500.0 cm-1
     A   4913, 4990, 5071, 5157, 5248, 5347, 5456, 5575, 5709, 5850,
     B   5995, 6145, 6298, 6459, 6637, 6819, 6992, 7168, 7351, 7546,
     C   7763, 7986, 8201, 8416, 8639, 8862, 9073, 9281, 9494, 9706,
     D   9917,10119,10297,10469,10645,10821,10995,11168,11340,11505,
     E  11656,11799,11933,12061,12181,12299,12423,12541,12638,12725,
     F  12805,12882,12960,13037,13109,13179,13243,13306,13374,13439,
     G  13490,13536,13580,13625,13677,13726,13764,13798,13830,13862,
     H  13893,13925,13963,14002,14036,14067,14096,14123,14145,14168,
     I  14197,14225,14249,14271,14295,14318,14342,14365,14391,14413,
     J  14420,14425,14436,14449,14466,14485,14512,14535,14544,14547,
     K  14548,14547,14545,14547,14557,14572,14591,14609,14617,14622,
     L  14627,14635,14648,14660,14661,14660,14660,14660,14660,14660,
     M  14660,14660,14653,14647,14653,14660,14660,14660,14660,14660,
     N  14656,14647,14628,14609,14603,14597,14579,14560,14547,14534,
     O  14516,14498,14486,14473,14456,14437,14419,14401,14384,14365/
      DATA MINO33/  !    -log10(Ni)*10000 from 1505.0 - 2000.0 cm-1
     A  14341,14318,14304,14283,14233,14168,14090,13999,13887,13765,
     B  13638,13499,13337,13156,12952,12718,12427,12096,11709,11308,
     C  10937,10559,10123, 9705, 9351, 9065, 8890, 8793, 8787, 8864,
     D   9061, 9317, 9591, 9909,10313,10748,11174,11620,12117,12634,
     E  13150,13677,14262,14790,15074,15324,15730,16159,16539,16877,
     F  17118,17331,17568,17803,18027,18239,18429,18606,18774,18932,
     G  19079,19209,19307,19396,19493,19584,19649,19707,19770,19828,
     H  19873,19913,19960,20001,20015,20022,20035,20044,20040,20031,
     I  20017,19999,19981,19958,19918,19873,19832,19787,19726,19667,
     J  19630,19586,19492,19394,19334,19279,19209,19137,19064,18990/ 
C            
C 
      DATA CXMNO3/.9861528/, CRHNO3/.28/, CNRNO3/1.554/, CNRH2O/1.333/ 
  
      DATA IFIRST/1/ 
C                                  
C-----------------------------------------------------------------------              
C     Tang & Munkelwitz (1996) JGR 101, 19245-19250     (water activity)
C     Tang et al (1981) Atmos Environ 15, 2463-2472    (refracive index) 
C-----------------------------------------------------------------------              
C                 
      AWNO3(X)=1.D0-3.65D-01*X-9.155D-02*X**2-2.826D-01*X**3      ! TM96
      DWNO3(X)=    -3.65D-01  -18.31D-02*X   -8.478D-01*X**2 
      RONO3(X)=0.9971D0+4.05D-01*X+9.0D-02*X**2                   ! TM96 
      FR1NO3(X)=1.3337+0.119D0*X          !     (X<0.205)          TWM81
      FR2NO3(X)=1.3285+0.145D0*X          !     (X>0.205)          TWM81
C 
C     Initialize:
C                WAVLEN,WAVNUM and XNRNO3,XNINO3,XNLNO3 spectral data
C                Also calls WATER to initialize  XNRH2O,XNIH2O,XNLH2O 
C     ---------------------------------------------------------------
C   
      CONFAC=CNRNO3/CNRH2O
      IF(IFIRST.EQ.1) THEN
      DO 110 I=1,480
      WAVLEN(I)=0.2D0+(I-1)*0.01D0  
      XNRNO3(I)=(1.D0+NNRNO3(I)/100000.D0)*CONFAC
      XNLNO3(I)=-NNINO3(I)/10000.D0
      XNINO3(I)=10.D0**XNLNO3(I)
      XNLNO3(I)=LOG10(XNINO3(I))
      WAVNUM(I)=10000.D0/WAVLEN(I) 
  110 CONTINUE
      J=480
      DO 120 II=1,400
      I=401-II
      J=J+1
      WAVN=2005.D0-II*5
      WAVLEN(J)=10000.D0/WAVN 
      XNRNO3(J)=MNRNO3(I)/10000.D0*CONFAC
      XNLNO3(J)=-MNINO3(I)/10000.D0
      XNINO3(J)=10.D0**XNLNO3(J)
      XNLNO3(J)=LOG10(XNINO3(J))
      WAVNUM(J)=WAVN      
  120 CONTINUE    
      WAV0=0.5
      CALL  WATER(WAV0,XNR0,XNI0) 
      IFIRST=0
      ENDIF
C
C-----------------------------------------------------------------------
C     Newton-Raphson iteration is used to obtain mass fraction X for the
C     specified relative humidity RH using the T&M (1996) water activity 
C     formula determined at the HeNe laser wavelength of 0.633 microns.
C
C     Ammonium Nitrate solution refractive index for the mass fraction X  
C     is used to obtain a refractive index proportionality factor: WTNO3
C     to linearly interpolate the RH dependence of both real & imaginary 
C     refractive index between the (dry) Ammonium Nitrate and pure Water 
C     values - taken to apply for all other wavelengths of the spectrum.
C-----------------------------------------------------------------------
C  
      WTNO3=1.0
      IF(RH.LT.CRHNO3) GO TO 140
      XM1=CXMNO3
      RH1=AWNO3(XM1)
      DM2=DWNO3(XM1)
      DO 130 I=1,10
      XM2=XM1+(RH-RH1)/DM2
      RH2=AWNO3(XM2)
      DM2=DWNO3(XM2)                                 
      DRH=RH-RH2      
 6111 FORMAT(I5,8F15.8)      
      XM1=XM2
      RH1=RH2        
  130 CONTINUE 
      IF(XM1.LT.0.205) THEN
      RHXNR=FR1NO3(XM1)
      ELSE
      RHXNR=FR2NO3(XM1)
      ENDIF        
      WTNO3=(RHXNR-CNRH2O)/(CNRNO3-CNRH2O) 
  140 CONTINUE  
      IF(RH.GT.0.999) WTNO3=0.0
      WTH2O=1.0-WTNO3
      DO 150 I=1,880
      RHRNO3(I)=WTH2O*XNRH2O(I)+WTNO3*XNRNO3(I)
      RHINO3(I)=WTH2O*XNIH2O(I)+WTNO3*XNINO3(I) 
      RHLNO3(I)=LOG10(RHINO3(I)) 
  150 CONTINUE 
C     
      IF(WAVL.GT.5.0) THEN
      WW=2000.D0/WAVL
      ELSE
      WW=(WAVL-0.2D0)*100.D0+1.D0
      ENDIF
      IW=WW  
      WTJ=WW-IW
      IF(IW.LT.1) IW=1
      JW=IW+1  
      IF(WAVL.GT.5.0) THEN  
      WTJ=1.D0-WTJ
      IW=880-IW
      JW=IW+1
      ENDIF 
      WTI=1.D0-WTJ
      XNR=WTI*RHRNO3(IW)+WTJ*RHRNO3(JW)
      XNL=WTI*RHLNO3(IW)+WTJ*RHLNO3(JW)
      XNI=10.D0**XNL
      RETURN
      END   

      SUBROUTINE SEASAL(RH,WAVL,XNR,XNI)
      IMPLICIT REAL*8 (A-H,O-Z)  
      COMMON/MRICOM/XNRH2O(880),XNRSO4(880),XNRNO3(880),XNRSEA(880)
     A             ,XNIH2O(880),XNISO4(880),XNINO3(880),XNISEA(880)
     B             ,XNLH2O(880),XNLSO4(880),XNLNO3(880),XNLSEA(880)
     C             ,WAVLEN(880),RHRSO4(880),RHRNO3(880),RHRSEA(880)  
     D             ,WAVNUM(880),RHISO4(880),RHINO3(880),RHISEA(880) 
     E                         ,RHLSO4(880),RHLNO3(880),RHLSEA(880) 

!f2py intent(in) rh, wavl    
!f2py intent(out) xnr, xni

C
C-----------------------------------------------------------------------
C     SEASAL   Returns real and imaginary refractive indices of Sea Salt          
C
C     Input:   WAVL  Wavelength in microns (between 0.2 to 2000 microns)
C
C     Output:  XNR, XNI  Real and imaginary refractive index 
C          
C              Also available in COMMON/MRICOM/, the spectral dependence
C              of real (XNRSEA) and imaginary (XNISEA) refaractive index
C              from 0.2 to 2000 microns (0.01 increment 0.2-5.0 microns)
C              from 5 to 2000 microns: (5 cm-1 increment 2000 to 5 cm-1)
C              Wavelength is given in WAVLEN (microns) and WAVNUM (cm-1)
C
C              Spectral interpolation is linear for XNR, linear in log10
C              for XNI using XNLSEA which is log10(XNI) in COMMON/MRICOM
C-----------------------------------------------------------------------
C     Remarks:
C              The refractive indices of dry Sea Salt are smoothly 
C              interpolated from data tabulated by:        
C
C              Nilsson (1979) Appl Opt 18, 3457-3473
C              Shettle & Fenn (1979) AFGL-TR-79-0214
C              
C              N79 and SF79 are based on IR measurements by Volz (1972)
C              SF79 utilize visible range measurements by Dorsey (1940)
C
C              SF79 data are used for Nr and Ni from 0.2 to 2.5 microns
C              Cubic Spline smoothed average of N79 and SF79 Nr,Ni data
C              is used for wavelengths longward of 2.5 microns.
C
C              Spectral extrapolation is applied longward of 40 microns          
C      
C              Crystalization point is RHC=0.47 (Nr,Ni=dry for RH < RHC)
C-----------------------------------------------------------------------
C
      DIMENSION NNRSEA(480),NNISEA(480) 
      DIMENSION NRSEA1(180),NRSEA2(180),NRSEA3(120)
      DIMENSION NISEA1(180),NISEA2(180),NISEA3(120)  
      EQUIVALENCE (NNRSEA(  1),NRSEA1(1)),(NNRSEA(181),NRSEA2(1))
      EQUIVALENCE (NNRSEA(361),NRSEA3(1)),(NNISEA(  1),NISEA1(1))
      EQUIVALENCE (NNISEA(181),NISEA2(1)),(NNISEA(361),NISEA3(1)) 
C
      DATA NRSEA1/  !           (Nr)*10000 from 0.20 - 1.99 microns
     A  15150,15144,15137,15131,15125,15118,15112,15106,15100,15094,
     B  15088,15082,15076,15070,15064,15058,15053,15047,15041,15035,
     C  15030,15024,15019,15013,15008,15002,14997,14991,14985,14979,
     D  14973,14968,14962,14956,14950,14945,14939,14933,14928,14923,
     E  14917,14912,14907,14902,14896,14891,14886,14881,14876,14872,
     F  14867,14863,14858,14854,14850,14846,14842,14837,14833,14829,
     G  14824,14820,14816,14812,14808,14804,14800,14796,14792,14788,
     H  14784,14780,14776,14772,14769,14765,14762,14759,14755,14752,
     I  14748,14745,14741,14738,14735,14731,14728,14725,14722,14718,
     J  14716,14713,14710,14707,14705,14702,14699,14697,14694,14691,
     K  14688,14685,14682,14679,14676,14673,14670,14667,14664,14661,
     L  14659,14656,14653,14650,14647,14645,14642,14639,14637,14634,
     M  14632,14629,14627,14624,14622,14619,14617,14615,14613,14611,
     N  14608,14606,14604,14601,14599,14597,14594,14592,14590,14587,
     O  14585,14582,14580,14577,14575,14573,14570,14568,14565,14563,
     P  14560,14557,14555,14552,14550,14547,14544,14541,14539,14536,
     Q  14533,14530,14527,14525,14522,14519,14516,14514,14511,14508,
     R  14506,14504,14501,14498,14495,14493,14490,14487,14484,14482/
      DATA NRSEA2/  !          (Nr1)*10000 from 2.00 - 3.79 microns
     A  14479,14476,14473,14471,14468,14465,14462,14459,14456,14453,
     B  14450,14447,14444,14441,14437,14434,14431,14428,14424,14421,
     C  14418,14414,14411,14407,14404,14400,14396,14393,14390,14386,
     D  14383,14379,14375,14372,14368,14364,14360,14356,14351,14346,
     E  14340,14334,14328,14323,14317,14310,14303,14296,14288,14280,
     F  14270,14259,14247,14234,14220,14206,14192,14178,14164,14152,
     G  14140,14128,14116,14103,14091,14079,14068,14060,14053,14050,
     H  14050,14052,14054,14058,14063,14071,14083,14099,14120,14147,
     I  14180,14217,14256,14297,14341,14388,14441,14499,14564,14636,
     J  14716,14806,14905,15015,15136,15270,15427,15606,15788,15954,
     K  16085,16098,16091,16065,16023,15968,15901,15826,15745,15659,
     L  15573,15487,15404,15327,15258,15200,15157,15115,15073,15033,
     M  14995,14975,14958,14943,14929,14918,14908,14900,14893,14887,
     N  14882,14878,14874,14870,14867,14864,14860,14856,14852,14846,
     O  14842,14839,14837,14835,14834,14832,14831,14830,14829,14827,
     P  14825,14822,14819,14816,14812,14808,14804,14799,14795,14790,
     Q  14785,14780,14775,14770,14765,14761,14756,14752,14748,14744,
     R  14741,14738,14735,14733,14731,14730,14729,14729,14729,14730/
      DATA NRSEA3/  !          (Nr1)*10000 from 3.80 - 4.99 microns
     A  14731,14732,14733,14735,14737,14740,14742,14745,14747,14750,
     B  14753,14756,14759,14762,14765,14768,14770,14773,14776,14778,
     C  14780,14782,14784,14787,14789,14792,14795,14798,14801,14804,
     D  14807,14810,14814,14817,14820,14824,14827,14831,14834,14837,
     E  14841,14844,14848,14851,14854,14857,14860,14863,14866,14869,
     F  14871,14874,14876,14878,14880,14882,14884,14885,14886,14887,
     G  14888,14888,14889,14889,14888,14888,14887,14886,14884,14882,
     H  14880,14877,14875,14871,14868,14864,14860,14856,14852,14847,
     I  14842,14838,14833,14828,14823,14818,14813,14808,14803,14798,
     J  14793,14789,14784,14780,14776,14772,14768,14764,14761,14757,
     K  14753,14750,14746,14743,14739,14736,14732,14729,14725,14721,
     L  14718,14714,14710,14706,14702,14698,14694,14689,14685,14680/
      DATA NISEA1/  !     -log10(Ni)*10000 from 0.20 - 1.99 microns
     A  39999,43324,46287,48889,51130,53009,54283,54951,55381,55938,
     B  56989,58632,60577,62606,64521,66474,68481,70451,72293,73916,
     C  75228,76083,76482,76550,76417,76210,76055,76081,76414,77186,
     D  78418,79625,80262,80361,80187,79999,79879,79727,79526,79260,
     E  78911,78464,77902,77209,76350,75305,74132,72893,71652,70472,
     F  69396,68371,67383,66429,65505,64606,63729,62869,62022,61184,
     G  60351,59519,58684,57841,56987,56117,55228,54309,53358,52379,
     H  51380,50364,49339,48308,47278,46254,45243,44248,43276,42333,
     I  41423,40553,39728,38954,38235,37579,36989,36599,36275,36004,
     J  35777,35586,35424,35285,35165,35059,34965,34880,34802,34729,
     K  34661,34597,34536,34477,34418,34359,34298,34232,34160,34077,
     L  33978,33880,33785,33693,33603,33516,33432,33350,33270,33193,
     M  33117,33043,32971,32901,32832,32764,32698,32632,32568,32504,
     N  32441,32379,32316,32255,32193,32133,32075,32020,31966,31913,
     O  31862,31813,31765,31718,31672,31627,31582,31539,31495,31453,
     P  31410,31367,31325,31282,31239,31196,31152,31107,31062,31015,
     Q  30968,30922,30878,30836,30796,30757,30719,30681,30643,30605,
     R  30565,30523,30480,30434,30384,30332,30275,30214,30148,30076/
      DATA NISEA2/  !     -log10(Ni)*10000 from 2.00 - 3.79 microns
     A  29999,29916,29830,29739,29645,29547,29445,29340,29232,29120,
     B  29005,28887,28767,28643,28517,28388,28257,28124,27988,27851,
     C  27711,27570,27427,27282,27136,26989,26837,26679,26516,26347,
     D  26173,25979,25787,25596,25407,25219,25033,24849,24666,24485,
     E  24305,24126,23947,23769,23593,23418,23246,23077,22912,22751,
     F  22595,22444,22297,22154,22016,21882,21751,21624,21501,21380,
     G  21263,21149,21037,20928,20821,20717,20614,20514,20415,20317,
     H  20221,20122,20018,19913,19809,19709,19617,19535,19466,19414,
     I  19381,19368,19372,19392,19427,19477,19540,19615,19702,19799,
     J  19906,20021,20144,20274,20410,20551,20696,20843,20993,21146,
     K  21305,21470,21641,21820,22006,22200,22403,22615,22836,23066,
     L  23323,23574,23831,24090,24354,24622,24923,25224,25515,25783,
     M  26019,26177,26306,26407,26486,26543,26582,26606,26617,26617,
     N  26611,26599,26586,26573,26563,26559,26565,26581,26612,26660,
     O  26723,26792,26865,26941,27018,27094,27169,27242,27313,27381,
     P  27446,27530,27616,27704,27794,27885,27976,28067,28158,28247,
     Q  28333,28419,28501,28580,28655,28726,28793,28856,28915,28969,
     R  29019,29065,29106,29144,29177,29207,29218,29226,29232,29232/
      DATA NISEA3/  !     -log10(Ni)*10000 from 3.80 - 4.99 microns
     A  29228,29198,29160,29114,29060,29000,28933,28860,28782,28699,
     B  28612,28521,28428,28333,28237,28140,28045,27951,27861,27775,
     C  27694,27632,27572,27511,27451,27392,27334,27276,27219,27162,
     D  27107,27052,26997,26943,26891,26839,26787,26737,26687,26638,
     E  26591,26543,26498,26453,26409,26366,26324,26283,26243,26205,
     F  26167,26130,26095,26061,26028,25997,25966,25938,25910,25884,
     G  25859,25835,25814,25793,25773,25755,25738,25723,25709,25696,
     H  25685,25702,25722,25745,25770,25798,25826,25856,25887,25919,
     I  25950,25981,26011,26041,26069,26096,26120,26143,26162,26180,
     J  26194,26204,26211,26215,26205,26193,26178,26162,26144,26124,
     K  26103,26081,26058,26033,26007,25982,25955,25928,25901,25873,
     L  25846,25819,25792,25765,25740,25715,25691,25667,25646,25625/ 
C
      DIMENSION MNRSEA(400),MNISEA(400)
      DIMENSION MRSEA1(150),MRSEA2(150),MRSEA3(100)
      DIMENSION MISEA1(150),MISEA2(150),MISEA3(100)  
      EQUIVALENCE (MNRSEA(  1),MRSEA1(1)),(MNRSEA(151),MRSEA2(1))
      EQUIVALENCE (MNRSEA(301),MRSEA3(1)),(MNISEA(  1),MISEA1(1))
      EQUIVALENCE (MNISEA(151),MISEA2(1)),(MNISEA(301),MISEA3(1))  
C
      DATA MRSEA1/  !             (Nr)*10000 from  5.0 - 750.0 cm-1
     A  15280,15320,15360,15400,15440,15480,15520,15560,15600,15640,
     B  15680,15720,15760,15800,15840,15880,15920,15960,16000,16040,
     C  16080,16120,16160,16200,16240,16280,16320,16360,16400,16440,
     D  16480,16520,16560,16600,16640,16680,16720,16760,16800,16840,
     E  16880,16920,16961,17001,17041,17080,17119,17158,17196,17234,
     F  17271,17308,17344,17378,17410,17438,17462,17483,17501,17516,
     G  17528,17538,17547,17556,17563,17570,17575,17577,17578,17576,
     H  17572,17565,17557,17547,17536,17525,17515,17506,17498,17492,
     I  17488,17486,17486,17487,17489,17491,17495,17499,17504,17509,
     J  17515,17521,17528,17536,17544,17552,17561,17570,17580,17590,
     K  17601,17610,17619,17628,17640,17654,17672,17697,17742,17795,
     L  17804,17741,17627,17474,17293,17097,16879,16619,16340,16063,
     M  15858,15641,15448,15280,15138,15019,14919,14832,14752,14676,
     N  14603,14532,14464,14399,14338,14284,14237,14197,14164,14139,
     O  14120,14107,14097,14090,14085,14081,14078,14076,14076,14076/
      DATA MRSEA2/  !           (Nr)*10000 from 775.0 - 1500.0 cm-1
     A  14078,14080,14083,14086,14092,14102,14117,14140,14173,14217,
     B  14271,14333,14401,14471,14539,14601,14654,14697,14730,14754,
     C  14772,14784,14794,14802,14810,14817,14825,14833,14842,14852,
     D  14864,14878,14893,14911,14930,14950,14972,14993,15015,15038,
     E  15062,15087,15114,15143,15175,15209,15247,15287,15329,15373,
     F  15418,15462,15506,15548,15588,15627,15665,15703,15741,15781,
     G  15822,15870,15920,15973,16029,16090,16157,16236,16339,16446,
     H  16534,16582,16580,16542,16473,16378,16261,16125,15974,15811,
     I  15574,15371,15169,14977,14802,14651,14525,14424,14347,14290,
     J  14246,14211,14181,14153,14128,14105,14085,14067,14052,14040,
     K  14031,14024,14019,14015,14012,14010,14011,14012,14016,14021,
     L  14028,14036,14046,14057,14070,14083,14097,14113,14129,14146,
     M  14164,14182,14201,14221,14241,14262,14284,14307,14331,14355,
     N  14380,14405,14429,14451,14471,14488,14502,14513,14522,14529,
     O  14535,14540,14544,14548,14552,14557,14561,14566,14572,14577/
      DATA MRSEA3/  !          (Nr)*10000 from 1505.0 - 2000.0 cm-1
     A  14582,14587,14595,14608,14628,14657,14697,14749,14813,14888,
     B  14979,15073,15168,15262,15354,15446,15535,15620,15700,15770,
     C  15826,15862,15819,15680,15524,15361,15195,15029,14864,14700,
     D  14557,14427,14317,14226,14156,14106,14073,14055,14048,14048,
     E  14053,14061,14070,14080,14090,14101,14111,14121,14132,14144,
     F  14156,14168,14180,14192,14205,14217,14230,14242,14254,14267,
     G  14279,14291,14304,14316,14329,14341,14354,14367,14380,14393,
     H  14406,14419,14432,14445,14459,14471,14484,14496,14508,14519,
     I  14530,14540,14549,14559,14567,14576,14584,14592,14600,14608,
     J  14615,14622,14629,14636,14643,14650,14656,14662,14669,14675/
      DATA MISEA1/  !        -log10(Ni)*10000 from 5.0 - 750.0 cm-1
     A      0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     B      0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
     C      2,    4,    6,    8,   10,   13,   16,   19,   22,   25,
     D     30,   35,   40,   50,   65,   85,  110,  140,  180,  230,
     E    330,  435,  545,  660,  785,  910, 1040, 1175, 1315, 1460,
     F   1610, 1770, 1930, 2110, 2305, 2525, 2765, 3025, 3305, 3605,
     G   3907, 4200, 4476, 4748, 5010, 5246, 5427, 5521, 5573, 5606,
     H   5642, 5700, 5780, 5886, 6024, 6185, 6352, 6514, 6662, 6787,
     I   6887, 6969, 7037, 7098, 7153, 7208, 7264, 7325, 7392, 7465,
     J   7539, 7615, 7691, 7766, 7839, 7912, 7986, 8061, 8140, 8223,
     K   8317, 8414, 8516, 8621, 8730, 8839, 8947, 9053, 9153, 9250,
     L   9348, 9444, 9533, 9627, 9736, 9870,10034,10221,10429,10656,
     M  10899,11156,11431,11724,12031,12350,12677,13010,13345,13679,
     N  14010,14334,14646,14931,15194,15409,15583,15727,15850,15959,
     O  16063,16168,16279,16391,16497,16598,16697,16793,16886,16978/
      DATA MISEA2/  !     -log10(Ni)*10000 from 755.0 - 1500.0 cm-1
     A  17069,17159,17249,17340,17424,17507,17587,17666,17744,17818,
     B  17893,17968,18042,18114,18181,18245,18300,18343,18380,18413,
     C  18441,18464,18484,18500,18511,18519,18524,18527,18529,18531,
     D  18534,18538,18540,18541,18542,18543,18543,18541,18534,18516,
     E  18495,18472,18445,18414,18378,18335,18286,18230,18166,18095,
     F  17999,17896,17789,17681,17576,17478,17381,17281,17174,17056,
     G  16921,16757,16575,16386,16203,16035,15894,15790,15710,15646,
     H  15591,15538,15488,15435,15382,15336,15300,15280,15280,15305,
     I  15367,15447,15540,15639,15738,15838,15943,16051,16164,16281,
     J  16402,16528,16657,16789,16925,17067,17212,17361,17509,17655,
     K  17799,17938,18074,18206,18337,18467,18596,18724,18852,18980,
     L  19107,19235,19362,19490,19618,19745,19873,20001,20129,20257,
     M  20385,20513,20641,20769,20896,21023,21150,21274,21400,21539,
     N  21689,21846,22010,22177,22345,22506,22662,22832,23013,23201,
     O  23393,23585,23774,23955,24122,24270,24393,24484,24538,24549/
      DATA MISEA3/  !    -log10(Ni)*10000 from 1505.0 - 2000.0 cm-1
     A  24513,24427,24290,24102,23864,23581,23256,22842,22260,21648,
     B  21033,20431,19853,19305,18792,18318,17888,17507,17182,16919,
     C  16725,16606,16590,16675,16818,17008,17233,17483,17748,18020,
     D  18290,18548,18786,19007,19234,19467,19703,19940,20176,20386,
     E  20594,20801,21005,21208,21410,21611,21809,22006,22201,22394,
     F  22585,22775,22963,23148,23332,23513,23692,23869,24043,24214,
     G  24383,24549,24711,24832,24882,24927,24969,25007,25041,25073,
     H  25103,25130,25155,25178,25199,25218,25237,25254,25270,25286,
     I  25300,25315,25328,25341,25355,25368,25381,25395,25409,25422,
     J  25437,25452,25468,25485,25503,25521,25540,25561,25583,25606/
C 
      DATA CXMSEA/.439572/, CRHSEA/.47/, CNRSEA/1.490/, CNRH2O/1.333/ 
C  
      DATA IFIRST/1/ 
C                                  
C-----------------------------------------------------------------------              
C     Tang & Munkelwitz (1996) JGR 99, 18801-18808      (water activity)
C                                                     (refractive index)
C     TM96 give results for pure NaCl (Nr=1.544)
C     
C     SF79 give real refractive index for Sea Salt Nr=1.49 at WAVL=0.633
C     The TM96 RH dependence for the real refractive index for pure NaCl
C     is scaled relative to Water by a factor (1.49-1.333)/(1.544-1.333)
C     to get the RH dependent real refractive index of Sea Salt solution 
C-----------------------------------------------------------------------              
C 
      AWSEA(X)=1.0D0-0.6366*X+0.8624*X**2-11.58*X**3+15.18*X**4   ! TM96
      DWSEA(X)=     -0.6366  +1.6248*X   -34.74*X**2+60.72*X**3 
      ROSEA(X)=0.9971+0.741*X-0.3741*X**2+2.252*X**3-2.060*X**4   ! TM96
      RRSEA(X)=3.70958+(8.95-3.70958)/(1.D0+(1.0-X)/X*58.448/18.0)
      VVSEA(X)=(18.0+(58.448-18.0)/(1.0+(1.0-X)/X*58.448/18.0))/ROSEA(X) 
      GNRSEA(X)=SQRT((2.000*RRSEA(X)+VVSEA(X))/(VVSEA(X)-RRSEA(X))) 
      FNRSEA(X)=1.333+(GNRSEA(X)-1.333)*(1.490-1.333)/(1.544-1.333)
  
C 
C     Initialize:
C                WAVLEN,WAVNUM and XNRSEA,XNISEA,XNLSEA spectral data
C                Also calls WATER to initialize  XNRH2O,XNIH2O,XNLH2O 
C     ---------------------------------------------------------------
C 
     
      IF(IFIRST.EQ.1) THEN
      DO 110 I=1,480
      WAVLEN(I)=0.2D0+(I-1)*0.01D0  
      XNRSEA(I)=NNRSEA(I)/10000.D0
      XNLSEA(I)=-NNISEA(I)/10000.D0
      XNISEA(I)=10.D0**XNLSEA(I) 
      WAVNUM(I)=10000.D0/WAVLEN(I)  
  110 CONTINUE
      J=480
      DO 120 II=1,400
      I=401-II
      J=J+1
      WAVN=2005.D0-II*5
      WAVLEN(J)=10000.D0/WAVN 
      XNRSEA(J)=MNRSEA(I)/10000.D0
      XNLSEA(J)=-MNISEA(I)/10000.D0  
      XNISEA(J)=10.D0**XNLSEA(J) 
      WAVNUM(J)=WAVN      
  120 CONTINUE    
      WAV0=0.5
      CALL WATER(WAV0,XNR0,XNI0) 
      IFIRST=0
      ENDIF
C
C-----------------------------------------------------------------------
C     Newton-Raphson iteration is used to obtain mass fraction X for the
C     specified relative humidity RH using the T&M (1996) water activity 
C     formula determined at the HeNe laser wavelength of 0.633 microns.
C
C     The refractive index for the mass fraction X for Sea Salt solution   
C     is used to obtain a refractive index proportionality factor: WTSEA
C     to linearly interpolate the RH dependence of both real & imaginary 
C     refractive index between the  (dry) Sea Salt and pure liquid Water 
C     values - taken to apply for all other wavelengths of the spectrum.
C-----------------------------------------------------------------------
C   
      WTSEA=1.0
      IF(RH.LT.CRHSEA) GO TO 140
      XM1=CXMSEA
      RH1=AWSEA(XM1)
      DM2=DWSEA(XM1)
      DO 130 I=1,10
      XM2=XM1+(RH-RH1)/DM2
      RH2=AWSEA(XM2)
      DM2=DWSEA(XM2)                                 
      DRH=RH-RH2       
      XM1=XM2
      RH1=RH2
  130 CONTINUE  
      RHXNR=FNRSEA(XM1) 
      GHXNR=GNRSEA(XM1)
      WTSEA=(RHXNR-CNRH2O)/(CNRSEA-CNRH2O) 
  140 CONTINUE  
      IF(RH.GT.0.999) WTSEA=0.0
      WTH2O=1.0-WTSEA  
      DO 150 I=1,880
      RHRSEA(I)=WTH2O*XNRH2O(I)+WTSEA*XNRSEA(I)
      RHISEA(I)=WTH2O*XNIH2O(I)+WTSEA*XNISEA(I) 
      RHLSEA(I)=LOG10(RHISEA(I)) 
  150 CONTINUE   
C   
      IF(WAVL.GT.5.0) THEN
      WW=2000.D0/WAVL
      ELSE
      WW=(WAVL-0.2D0)*100.D0+1.D0
      ENDIF
      IW=WW  
      WTJ=WW-IW
      IF(IW.LT.1) IW=1
      JW=IW+1  
      IF(WAVL.GT.5.0) THEN  
      WTJ=1.D0-WTJ
      IW=880-IW
      JW=IW+1
      ENDIF 
      WTI=1.D0-WTJ
      XNR=WTI*RHRSEA(IW)+WTJ*RHRSEA(JW)
      XNL=WTI*RHLSEA(IW)+WTJ*RHLSEA(JW)
      XNI=10.D0**XNL
      RETURN
      END   

